var $pg_client_js_inline="var DEF_EXT_VERSION=\"6.6.9\",DEF_DIS_ID=\"cndtsb\",DEF_SUB_DIS_ID=\"-\",DEF_POST_INSTALL_URL=\"\",$pg_namespace={PG_BASE_URL:\"http://smartbar.pricegong.com\",INJECTED_PATH:\"\",BROWSER_API_URL:\"../browserAppApi.js\",OFFERS_FILE_PATH:\"/offers/offers.html\",WHITE_LISTS_PATH:\"/SiteXMLFolder\",TOOLBAR_DLG_PATH:\"menu_dlg/pg_dlg.html\",AGREEMENT_DLG_PATH:\"agreement/agree.html\",global_msg_key:\"pg_global_msg_key\",extension_msg_key:\"pg_ext_msg_key\",offers_msg_key:\"pg_offers_msg_key\",agreement_msg_key:\"pg_agreement_msg_key\", " +
"preferences:{PG_LOGGING:!0,PG_LOCAL_HOST:\"pgcff.pricegong.com\"},SITE_TYPE_SEARCH_ENGINE:1,SITE_TYPE_ECOMMERCE:2,SITE_TYPE_TRAVEL:4,SITE_TYPE_CONDUIT_SE:8,DEFAULT_SITE_TYPE:0,IMPR_TYPE_URL_INVESTIGATION:1,IMPR_TYPE_RESULTS_PAGE_LINK:2,IMPR_TYPE_PRODUCT_PAGE:4,IMPR_TYPE_PRODUCT_PAGE_LINK:8,DEFAULT_IMPR_TYPE:0,SERVICE_TYPE_SHOPPING:1,SERVICE_TYPE_COUPONS:2,SERVICE_TYPE_TRAVEL:4,SERVICE_TYPE_COUPONS_HP:8,DEFAULT_SERVICE_TYPE:0,CATALOG_TYPE_XML:1,CATALOG_TYPE_WL:2,DEFAULT_CATALOG_TYPE:0,DEFAULT_UPGRADE_INFO:{new_ver:\"0.0.0\", " +
"url:\"\",span:0,has_new_version:!1},DEFAULT_CLIENT_VERSION:DEF_EXT_VERSION,DEFAULT_USER_GROUP:\"\",DEFAULT_GOOGLE_PATCH:!0,STG_KEY:{SERVER_LOCATION:\"pg_server_location\",SETTINGS_URL:\"pg_settings_url\",LAST_SETTINGS_UPDATE:\"pg_last_settings_update\",FIRST_RUN:\"pg_first_run\",FIRST_RUN_TIME:\"pg_first_run_time\",MACHINE_ID:\"pg_machine_id\",USER_ID:\"pg_user_id\",SNOOZE_TIME:\"pg_snooze_time\",IS_ENABLED:\"pg_is_enabled\",COUNTRY_CODE:\"pg_country_code\",LAST_UPGRADE_DISPLAY:\"pg_last_upgrade_disp\",CATALOG_TYPE:\"pg_catalog_type\", " +
"CATALOG_MODE:\"pg_catalog_mode\",CX_SERVER_LOCATION:\"pg_cx_server\",SETTINGS_UPDATE_INTERVAL:\"pg_settings_update_interval\",USER_GROUP:\"pg_user_group\",ACTIVE_SITE_TYPES:\"pg_active_site_types\",OFFERS_URL:\"pg_offers_url\",IMPR_TYPE:\"pg_impr_type\",EXTRA_PARAMS:\"pg_extra_params\",UPGRADE_INFO:\"pg_upgrade_info\",CLIENT_VERSION:\"pg_client_ver\",XML_CATALOGS_URL:\"pg_xml_catalogs_url\",WL_CATALOGS_URL:\"pg_wl_catalogs_url\",USER_AGREE:\"pg_user_agree\",DIST_ID:\"pg_dist_id\",SUB_DIST_ID:\"pg_sub_dist_id\",GOOGLE_PATCH:\"pg_google_patch\", " +
"OPT_ENABLE_SEARCH_ENGINES:\"pg_enable_search_engines\",OPT_ENABLE_ECOMM_SEARCH:\"pg_enable_ecomm_search\",POST_INSTALL_ACTION:\"pg_post_install_action\"},POST_INSTALL_URL:DEF_POST_INSTALL_URL,SNOOZE_MIN_MINUTES:0,SNOOZE_MAX_MINUTES:2880,PAGE_STATE_CREATED:\"created\",PAGE_STATE_LOADING:\"loading\",PAGE_STATE_LOADED:\"loaded\",PAGE_STATE_INIT:\"init\",PAGE_STATE_READY:\"ready\",PAGE_STATE_PARSING:\"parsing\",PAGE_STATE_PARSING_DONE:\"parsing_done\",PG_EXT_GUID:\"{8A9386B4-E958-4c4c-ADF4-8F26DB3E4829}\",gen_machine_id:function(){return $pg_namespace.num2hex(Math.random()* " +
"4294967295+1,8)+\"-\"+$pg_namespace.num2hex(Math.random()*4294967295+1,8)+$pg_namespace.num2hex(Math.random()*65535+1,4)},gen_uuid:function(){return $pg_namespace.num2hex(Math.random()*4294967295+1,8)+\"-\"+$pg_namespace.num2hex(Math.random()*65535+1,4)+\"-\"+$pg_namespace.num2hex(Math.random()*65535+1,4)+\"-\"+$pg_namespace.num2hex(Math.random()*65535+1,4)+\"-\"+$pg_namespace.num2hex(Math.random()*4294967295+1,8)+$pg_namespace.num2hex(Math.random()*65535+1,4)},pg_date_format:function(a){return a.getUTCDate()+ " +
"\"-\"+[\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"][a.getMonth()]+\"-\"+a.getUTCFullYear()+\" \"+a.getUTCHours()+\":\"+a.getUTCMinutes()+\":\"+a.getUTCSeconds()},loc_from_url:function(a){var b=document.createElement(\"a\");b.href=a;return b},get_url_query_params:function(a){for(var b={},a=$pg_namespace.loc_from_url(a).search.substring(1).split(\"&\"),c=0,d=a.length;c<d;++c){var e=a[c].split(\"=\"),f=e.length>1?e[1]:\"\";b[$pg_namespace.decodeURI(e[0])]=$pg_namespace.decodeURI(f)}return b}, " +
"escape:function(a){return a.replace(/[\\\\]/g,\"\\\\\\\\\").replace(/[\\\"]/g,\'\\\\\"\').replace(/[\']/g,\"\\\\\'\").replace(/[\\n]/g,\"\\\\n\").replace(/[\\r]/g,\"\\\\r\")},unescape:function(a){return a.replace(/\\\\\\\\/g,\"\\\\\").replace(/\\\\\\\"/g,\'\"\').replace(/\\\\\\\'/g,\"\'\").replace(/\\\\n/g,\"\\n\").replace(/\\\\r/g,\"\\r\")},extend:function(a,b){for(var c in b.prototype)typeof a.prototype[c]==\"undefined\"&&(a.prototype[c]=b.prototype[c]);return a},kv_pairs_from_str:function(a){for(var b=/([^\\/?&]+)={1}([^\\/?&]+)|([^\\/?&]+):{1}([^\\/?&]+)|([^\\/?&]+)-{1}([^\\/?&]+)/g, " +
"c={},d;(d=b.exec(a))!=null;){for(var e=1,f=d.length;e<f&&d[e]==void 0;)e+=2;e<f-1&&(c[d[e]]=d[e+1])}return c},find_value:function(a,b){var c=a.match(RegExp(\"(^|[/?&])\"+b+\"([^/?&]+)\",\"i\"));return c?c[2]:null},german_accents:\"\\u00c4\\u00e4\\u00d6\\u00f6\\u00dc\\u00fc\\u00df\\u20ac\",french_accents:\"\\u00c0\\u00c2\\u00c4\\u00c8\\u00c9\\u00ca\\u00cb\\u00ce\\u00cf\\u00d4\\u0152\\u00d9\\u00db\\u00dc\\u0178\\u00e0\\u00e2\\u00e4\\u00e8\\u00e9\\u00ea\\u00eb\\u00ee\\u00ef\\u00f4\\u0153\\u00f9\\u00fb\\u00fc\\u00ff\",italian_accents:\"\\u00c0\\u00c8\\u00c9\\u00cc\\u00d2\\u00d3\\u00d9\\u00e0\\u00e8\\u00e9\\u00ec\\u00f2\\u00f3\\u00f9\", " +
"spanish_accents:\"\\u00c1\\u00c9\\u00cd\\u00d3\\u00da\\u00d1\\u00dc\\u00e1\\u00e9\\u00ed\\u00f3\\u00fa\\u00f1\\u00fc\",all_accents:\"\\u00c4\\u00e4\\u00d6\\u00f6\\u00dc\\u00fc\\u00df\\u20ac\\u00c0\\u00c2\\u00c8\\u00c9\\u00ca\\u00cb\\u00ce\\u00cf\\u00d4\\u0152\\u00d9\\u00db\\u0178\\u00e0\\u00e2\\u00e8\\u00e9\\u00ea\\u00eb\\u00ee\\u00ef\\u00f4\\u0153\\u00f9\\u00fb\\u00ff\\u00cc\\u00d2\\u00d3\\u00ec\\u00f2\\u00f3\\u00c1\\u00cd\\u00da\\u00d1\\u00e1\\u00ed\\u00fa\\u00f1\",decode_reg_exp:function(a){var a=a.replace(/\\\\\\]/g,\"$hide_it_ti_edih$\"),b=a.match(/(\\[[^\\]]*\\[[^\\]]*\\][^\\]]*\\])/g); " +
"if(b)for(var c=0,d=b.length;c<d;++c)a=a.replace(b[c],b[c].replace(/\\][^$]/,\"\\\\]\"));a=a.replace(\"$hide_it_ti_edih$\",\"\\\\]\");b=$pg_namespace;return a.replace(\"~G~\",b.german_accents).replace(\"~F~\",b.french_accents).replace(\"~I~\",b.italian_accents).replace(\"~S~\",b.spanish_accents).replace(\"~A~\",b.all_accents)},unique:function(a){for(var b=\"\",c=0,d=a.length;c<d;++c){var e=a.charAt(c);-1==b.search(RegExp(e))&&(b+=e)}return b},chars2codes:function(a){for(var b=\"\",c=0,d=a.length;c<d;++c)b=b+\"\\\\u\"+$pg_namespace.num2hex(a.charCodeAt(c), " +
"4);return b},num2hex:function(a,b){a=Math.round(a);b=Math.round(b);a<0&&(a=4294967295+a+1);for(var c=a.toString(16),b=typeof b==\"number\"&&b>=0?b:4,d=c.length;d<b;++d)c=\"0\"+c;return c},pack_msg_params:function(){for(var a=Array.prototype.shift.call(arguments),b=[],c=0,d=arguments.length;c<d;++c)b.push(arguments[c]);return{method:a,args:b}},encodeURIComponent:function(a){return encodeURIComponent(a).replace(/!/g,\"%21\").replace(/\'/g,\"%27\").replace(/\\(/g,\"%28\").replace(/\\)/g,\"%29\").replace(/\\*/g,\"%2A\")}, " +
"decodeURI:function(a){try{return decodeURI(a)}catch(b){}try{return unescape(a)}catch(c){}return a},encode:function(a){if(typeof a!=\"string\")return a;for(var b=\"\",c=0,d=a.length;c<d;++c){var e=(c+1)%95,f=a.charCodeAt(c);f>=32&&f<=126&&(f=126-(f-32)+e,f=f<=126?f:32+(f-126-1));b+=String.fromCharCode(f)}return b},decode:function(a){if(typeof a!=\"string\")return a;for(var b=\"\",c=0,d=a.length;c<d;++c){var e=(c+1)%95,f=a.charCodeAt(c);f>=32&&f<=126&&(e=f-e,f=127-(e>=32?e-32:95-(32-e))-1);b+=String.fromCharCode(f)}return b}, " +
"add_class:function(a,b){var c=a.className.split(/\\s+/),b=b.toLowerCase();if(!c.some(function(a){return a==b}))c.push(b),a.className=c.join(\" \")},remove_class:function(a,b){var c=a.className.split(/\\s+/),b=b.toLowerCase();c.forEach(function(d,e){if(d.toLowerCase()==b)c.splice(e,1),a.className=c.join(\" \")})},has_class:function(a,b){var c=a.className.split(/\\s+/),b=b.toLowerCase();return c.some(function(a){return a==b})},str2hex:function(a){if(typeof a!=\"string\")return a;for(var b=\"\",c=0,d=a.length;c< " +
"d;++c){var e=a.charCodeAt(c).toString(16);e.length<2&&(e=\"0\"+e);b+=e}return b},hex2str:function(a){if(typeof a!=\"string\")return a;for(var b=\"\",c=0,d=a.length;c<d;c+=2){var e=a.substr(c,2);b+=String.fromCharCode(parseInt(e,16))}return b},jsonstr:function(a){return JSON.stringify(a,null,\" \")}};$pg_namespace.pg_ext_inst=$pg_namespace.num2hex(Math.random()*4294967295+1,8);$pg_namespace.extension_msg_key=$pg_namespace.extension_msg_key+\"_\"+$pg_namespace.pg_ext_inst;$pg_namespace.DEFAULT_SITE_TYPE=$pg_namespace.SITE_TYPE_ECOMMERCE; " +
"$pg_namespace.DEFAULT_IMPR_TYPE=$pg_namespace.IMPR_TYPE_PRODUCT_PAGE|$pg_namespace.IMPR_TYPE_URL_INVESTIGATION;$pg_namespace.DEFAULT_SERVICE_TYPE=$pg_namespace.SERVICE_TYPE_SHOPPING;$pg_namespace.DEFAULT_CATALOG_TYPE=$pg_namespace.CATALOG_TYPE_WL;$pg_namespace.logger=function(){return{init:function(){},debug:function(){},error:function(){}}}();if(typeof $pg_logging===\"undefined\")var $pg_logging=$pg_namespace.preferences.PG_LOGGING;if(typeof $pg_release_build===\"undefined\")var $pg_release_build=!1; " +
"var pgLog;if(!Array.prototype.forEach)Array.prototype.forEach=function(a,b){var c,d;if(this==null)throw new TypeError(\"this is null or not defined\");var e=Object(this),f=e.length>>>0;if({}.toString.call(a)!=\"[object Function]\")throw new TypeError(a+\" is not a function\");b&&(c=b);for(d=0;d<f;){var g;d in e&&(g=e[d],a.call(c,g,d,e));d++}}; " +
"if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a){if(this==null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(c===0)return-1;var d=0;arguments.length>0&&(d=Number(arguments[1]),d!=d?d=0:d!=0&&d!=Infinity&&d!=-Infinity&&(d=(d>0||-1)*Math.floor(Math.abs(d))));if(d>=c)return-1;for(d=d>=0?d:Math.max(c-Math.abs(d),0);d<c;d++)if(d in b&&b[d]===a)return d;return-1};if(!String.prototype.trim)String.prototype.trim=function(){return this.replace(/^\\s+|\\s+$/g,\"\")}; " +
"$pg_namespace.matcher=function(a,b){this.subject=a;this.rule=b;this.found=!1;this.id=this.value=null;this.logger=$pg_namespace.logger}; " +
"$pg_namespace.matcher.prototype={match:function(){this.found=!1;this.value=null},exec:function(){this.match();return this.match_found()},match_found:function(){return this.found},get_value:function(){try{if(!this.match_found())return\"\";if(typeof this.value==\"string\")return $pg_namespace.encodeURIComponent(\"@name\"in this.rule?this.rule[\"@name\"]:\"q\")+\"=\"+$pg_namespace.encodeURIComponent(this.value);var a=[];if(this.value)if(this.rule.fp){var b=this.rule.fp;\"#cdata\"in b&&(b=b[\"#cdata\"]);this.value.forEach(function(a){var c= " +
"\"@name\"in a.rule?a.rule[\"@name\"]:\"q\";a.url_value?a=a.url_value:(a=a.get_value(),a=a.replace($pg_namespace.encodeURIComponent(c)+\"=\",\"\"));b=b.replace(\"#\"+c+\"#\",a)});a.push(b)}else this.value.forEach(function(b){a.push(b.get_value())});return a.join(\"&\")}catch(c){}return\"\"},set_id:function(a){this.id=a[0];a.shift();this.id_args=a},is_hint:function(){return this.id==\"uv\"||this.id==\"uf\"},match_reg_exp:function(a,b){var c=RegExp($pg_namespace.decode_reg_exp(b),\"i\");if(c=a.match(c)){this.value=c[c.length- " +
"1].trim().toString();if(this.del)this.value=this.value.toLowerCase().replace(this.del,\"\");this.found=!0}},matcher_from_rule:function(a){if(\"js\"in a)return new $pg_namespace.javascript_matcher(this.subject,a);if(!(\"@id\"in a))return new $pg_namespace.dom_elem_matcher(this.subject,a);var b=a[\"@id\"].split(\":\");if(b.length==1)return a=new $pg_namespace.dom_elem_matcher(this.subject,a),a.set_id(b),a;var c={cnq:{matcher:$pg_namespace.dom_elem_matcher,id_parts:3},cnc:{matcher:$pg_namespace.dom_elem_matcher, " +
"id_parts:3},idc:{matcher:$pg_namespace.dom_elem_matcher,id_parts:3},\"const\":{matcher:$pg_namespace.const_matcher,id_parts:2},urex:{matcher:$pg_namespace.page_url_matcher,id_parts:2},trex:{matcher:$pg_namespace.doc_title_matcher,id_parts:2},trmv:{matcher:$pg_namespace.doc_title_matcher,id_parts:2},uvp:{matcher:$pg_namespace.page_url_matcher,id_parts:2},ufp:{matcher:$pg_namespace.page_url_matcher,id_parts:2},uv:{matcher:$pg_namespace.page_url_matcher,id_parts:2},uf:{matcher:$pg_namespace.page_url_matcher, " +
"id_parts:2}},d=b[0];if(d in c)return c=c[d],a=new c.matcher(this.subject,a),b.length>c.id_parts&&(c=b.splice(c.id_parts-1,b.length-c.id_parts+1),b.push(c.join(\":\"))),a.set_id(b),a;return null}}; " +
"$pg_namespace.url_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b);this.url=$pg_namespace.decodeURI(a.url).toLowerCase();this.rex_only=\"@rex_only\"in this.rule&&this.rule[\"@rex_only\"]==\"1\";this.key_part=\"del\"in this.rule?this.rule.del.toLowerCase():null;this.reg_exp=b.reg.toLowerCase();this.reg_exp=this.reg_exp.replace(/([^\\\\]?)\\{/g,\"$1(\").replace(/([^\\\\]?)\\}/g,\"$1)\");this.url_value=null;this.url_found=!1}; " +
"$pg_namespace.url_matcher.prototype={match:function(){this.value=[];$pg_namespace.matcher.prototype.match.apply(this,arguments);if(!this.rex_only&&this.key_part)this.url_value=$pg_namespace.find_value(this.url,this.key_part),this.url_found=this.url_value!=null;if(!this.url_found&&($pg_namespace.matcher.prototype.match_reg_exp.call(this,this.url,this.reg_exp),this.url_found=this.found,this.url_value=this.value,this.found=!1,this.value=[],this.url_found&&this.key_part))this.url_value=this.url_value.replace(this.key_part, " +
"\"\");if(this.url_found&&\"param\"in this.rule){var a=this.rule.param;a.length==void 0&&(a=[a]);this.value=[];for(var b=0,c=a.length;b<c;++b){var d=this.matcher_from_rule(a[b]);if(d.exec())this.value.push(d),this.found=!0}}},match_found:function(){return this.url_found},get_value:function(){try{if(!this.match_found())return\"\";var a=$pg_namespace.matcher.prototype.get_value.call(this),b=\"q=\"+this.url_value.trim().toString();a.length>0&&(b=b+\"&\"+a);return b}catch(c){}return\"\"}}; " +
"$pg_namespace.extend($pg_namespace.url_matcher,$pg_namespace.matcher);$pg_namespace.dom_elem_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b);this.doc=a.doc;this.del=\"@del\"in this.rule?this.rule[\"@del\"].toLowerCase():null}; " +
"$pg_namespace.dom_elem_matcher.prototype={match:function(){$pg_namespace.matcher.prototype.match.apply(this,arguments);var a=this.rule,b=this.get_root_elem();if(b&&(\"#text\"in a&&(b=this.walk(b,a[\"#text\"])),b&&!(\"@tag\"in a&&b.tagName.toLowerCase()!=a[\"@tag\"].toLowerCase()))){if(\"@attribute\"in a&&a[\"@attribute\"].length>0){var c=a[\"@attribute\"],d=a[\"@value\"],a=RegExp(\"@type\"in a&&a[\"@type\"].toLowerCase()==\"contain\"?d:\"^\"+d+\"$\",\"i\"),d=b.getAttribute(c);if(!d||d==null)return;this.del&&(d=d.toLowerCase().replace(this.del, " +
"\"\"));if(!d.match(a))return}else if(\"@value\"in a&&a[\"@value\"].length>0&&(c=b.innerText||b.textContent,this.del&&(c=c.toLowerCase().replace(this.del,\"\")),d=a[\"@value\"],a=RegExp(\"@type\"in a&&a[\"@type\"].toLowerCase()==\"contain\"?d:\"^\"+d+\"$\",\"i\"),!c.match(a)))return;this.found=!0;this.value=b}},get_root_elem:function(){if(!(\"@id\"in this.rule))return this.doc;if(this.id_args.length==0)return this.doc.getElementById(this.id);for(var a=this.id,b=this.id_args[1],c=this.doc.getElementsByTagName(this.id_args[0]), " +
"d=a==\"cnq\"||a==\"cnc\"?\"class\":\"id\",a=RegExp(a==\"idc\"||a==\"cnc\"?b:\"^\"+b+\"$\"),e=0,f=c.length;e<f;++e){var g=c[e];if((b=g.getAttribute(d))&&b.match(a))return g}return null},walk_map:{c:\"firstChild\",s:\"nextSibling\",r:\"previousSibling\",p:\"parentNode\",l:\"lastChild\"},walk:function(a,b){if(!a||b.length==0)return a;var c=b.charAt(0),d=this.walk_map[c.toLowerCase()];if((a=a[d])&&c.toLowerCase()==c){c=this.walk_map[d==\"nextSibling\"||d==\"firstChild\"?\"s\":\"r\"];for(d=a;a&&(a.nodeType==Node.TEXT_NODE||a.nodeType== " +
"Node.COMMENT_NODE);)(a=a[c])&&(d=a);a=d}return this.walk(a,b.substr(1))},get_value:function(){if(this.match_found()&&(this.value=(this.value.innerText||this.value.textContent).trim().toString(),this.del))this.value=this.value.toLowerCase().replace(this.del,\"\");return $pg_namespace.matcher.prototype.get_value.call(this)}};$pg_namespace.extend($pg_namespace.dom_elem_matcher,$pg_namespace.matcher);$pg_namespace.const_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b)}; " +
"$pg_namespace.const_matcher.prototype={match:function(){$pg_namespace.matcher.prototype.match.apply(this,arguments);this.value=this.rule[\"@id\"].split(\":\")[1];this.found=!0}};$pg_namespace.extend($pg_namespace.const_matcher,$pg_namespace.matcher);$pg_namespace.javascript_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b);if(\"#cdata\"in b.js)b.js=b.js[\"#cdata\"]}; " +
"$pg_namespace.javascript_matcher.prototype={match:function(){$pg_namespace.matcher.prototype.match.apply(this,arguments);try{this.found=this.value=eval(\"var document = this.subject.doc; function pgFoo() {\"+this.rule.js+\"}; this.value = pgFoo();\")}catch(a){this.found=!1}}};$pg_namespace.extend($pg_namespace.javascript_matcher,$pg_namespace.matcher); " +
"$pg_namespace.page_url_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b);this.url=$pg_namespace.decodeURI(a.url).toLowerCase();this.del=\"@del\"in this.rule?this.rule[\"@del\"].toLowerCase():null;this.url_value=null;this.url_found=!1}; " +
"$pg_namespace.page_url_matcher.prototype={match:function(){$pg_namespace.matcher.prototype.match.apply(this,arguments);var a=\"match_\"+this.id;if(a in this)this[a](this.id_args[0])},match_urex:function(a){$pg_namespace.matcher.prototype.match_reg_exp.call(this,this.url,a);this.url_found=this.found;this.url_value=this.value;this.found=!1;this.value=[];if(this.match_found()&&\"@value\"in this.rule){var a=this.rule[\"@value\"].toLowerCase(),b=\"@type\"in this.rule&&this.rule[\"@type\"].toLowerCase()==\"equal\"? " +
"\"equal\":\"contain\";this.url_value=this.url_value.toLowerCase();if(this.del)this.url_value=this.url_value.toLowerCase().replace(this.del,\"\");if(b==\"equal\"&&this.url_value!=a||b==\"contain\"&&this.url_value.indexOf(a)==-1)this.url_value=null,this.url_found=!1}},match_uvp:function(a){var b=$pg_namespace.kv_pairs_from_str(this.url),a=a.toLowerCase(),c;for(c in b)if(c==a){this.url_value=b[c].trim().toString();if(this.del)this.url_value=this.url_value.toLowerCase().replace(this.del,\"\");this.url_found=!0;break}}, " +
"match_ufp:function(a){var b=this.subject.doc.location.pathname;b.charAt(0)==\"/\"&&(b=b.substring(1));b=b.split(\"/\");if(b.length>=a){this.url_value=b[a-1].trim().toString();if(this.del)this.url_value=this.url_value.toLowerCase().replace(this.del,\"\");this.url_found=!0}},match_uv:function(a){this.match_uvp(a)},match_uf:function(a){this.match_ufp(a)},match_found:function(){return this.url_found},get_value:function(){if(!this.match_found())return\"\";var a=$pg_namespace.matcher.prototype.get_value.call(this), " +
"b=$pg_namespace.encodeURIComponent(\"@name\"in this.rule?this.rule[\"@name\"]:\"q\")+\"=\"+this.url_value.trim().toString();a.length>0&&(b=b+\"&\"+a);return b}};$pg_namespace.extend($pg_namespace.page_url_matcher,$pg_namespace.matcher);$pg_namespace.doc_title_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b);this.title=a.title;this.del=\"@del\"in this.rule?this.rule[\"@del\"].toLowerCase():null}; " +
"$pg_namespace.doc_title_matcher.prototype={match:function(){$pg_namespace.matcher.prototype.match.apply(this,arguments);var a=\"match_\"+this.id;if(a in this)this[a](this.id_args[0])},match_trex:function(a){$pg_namespace.matcher.prototype.match_reg_exp.call(this,this.title,a)},match_trmv:function(a){var b=this.title.toLowerCase();a.toLowerCase().split(\";\").forEach(function(a){b=b.replace(RegExp(a,\"gi\"),\"\")});if(b.length)this.value=b.trim().toString(),this.del&&(attribute=attribute.toLowerCase().replace(this.del, " +
"\"\")),this.found=!0}};$pg_namespace.extend($pg_namespace.doc_title_matcher,$pg_namespace.matcher);$pg_namespace.product_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b);this.service_type=\"@service\"in b?b[\"@service\"]:$pg_namespace.DEFAULT_SERVICE_TYPE}; " +
"$pg_namespace.product_matcher.prototype={match:function(){$pg_namespace.matcher.prototype.match.apply(this,arguments);if(\"match\"in this.rule){var a=this.rule.match;a.length==void 0&&(a=[a]);for(var b=0,c=a.length;b<c;++b){var d=a[b],d=this.matcher_from_rule(d);if(!d.exec())return}}if(\"param\"in this.rule){a=this.rule.param;a.length==void 0&&(a=[a]);this.value=[];b=0;for(c=a.length;b<c;++b)if(d=a[b],d=this.matcher_from_rule(d),d.exec())this.value.push(d),this.found=this.found||!d.is_hint()}},get_value:function(){var a= " +
"$pg_namespace.matcher.prototype.get_value.call(this);if(a.length==0)return a;if(\"param\"in this.rule&&this.rule.fp){var b=this.rule.param;b.length==void 0&&(b=[b]);for(var c=0,d=b.length;c<d;++c)var e=b[c],a=a.replace(\"#\"+(\"@name\"in e?e[\"@name\"]:\"q\")+\"#\",\"\")}return[a,\"service=\"+this.service_type].join(\"&\")}};$pg_namespace.extend($pg_namespace.product_matcher,$pg_namespace.matcher); " +
"$pg_namespace.site_matcher=function(a,b,c){var d={};a?(d.doc=a,d.url=a.location.href,d.title=a.title):(d.doc=null,d.url=b,d.title=\"\");$pg_namespace.matcher.call(this,d,c);this.site_id=\"@id\"in c?c[\"@id\"]:\"\";this.site_type=\"@type\"in c?parseInt(c[\"@type\"]):$pg_namespace.DEFAULT_SITE_TYPE}; " +
"$pg_namespace.site_matcher.prototype={match:function(){try{$pg_namespace.matcher.prototype.match.apply(this,arguments);this.value=[];var a=this.rule;if(!this.subject.doc&&\"url\"in a){if(a.url.length==void 0)a.url=[a.url];for(var b=0,c=a.url.length;b<c;++b){var d=new $pg_namespace.url_matcher(this.subject,a.url[b]);if(d.exec()){this.value.push(d);this.found=!0;return}}}if(this.subject.doc&&!this.match_found()&&this.subject.doc&&\"product\"in a){if(a.product.length==void 0)a.product=[a.product];b=0;for(c= " +
"a.product.length;b<c;++b)if(d=new $pg_namespace.product_matcher(this.subject,a.product[b]),d.exec()){this.value.push(d);this.found=!0;break}}}catch(e){}},get_value:function(){try{var a=$pg_namespace.matcher.prototype.get_value.call(this);if(a.length==0)return a}catch(b){}return[a,\"site_num=\"+this.site_id,\"st=\"+this.site_type].join(\"&\")}};$pg_namespace.extend($pg_namespace.site_matcher,$pg_namespace.matcher); " +
"function addListener(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent(\"on\"+b,c)} " +
"$pg_namespace.page_handler=function(a){this.logger=$pg_namespace.logger;this.page_tab_id=-1;conduitPage.onRequest.addListener(\"msg_from_app\",this.on_message(this));this.doc=a;window.setTimeout(function(a){return function(){a.extension_call(\"on_page_ready\")}}(this),1);this.reparse={is_on:!1,timer:0,delay:2E3,host:\"\",rules_str:null,last_search:\"\",cur_search:\"\",last_result:{success:!1,params:\"\"}};this.prefs={};this.g_hooked=!1;this.is_post_hook_enabled()&&this.post_hook()}; " +
"$pg_namespace.page_handler.prototype={handleEvent:function(a){var b=this.doc.getElementById(\"lst-ib\");if(a.type=a.target==b)if(this.is_google_patch_enabled()){if(this.reparse.cur_search!=b.value&&(this.reparse.cur_search=b.value,this.reparse.timer&&window.clearTimeout(this.reparse.timer),this.reparse.cur_search!=this.reparse.last_search))$this=this,this.reparse.timer=window.setTimeout(function(){$this.reparse.timer=0;$this.reparse.is_on=!0;$this.parse($this.reparse.host,$this.reparse.rules_str,$this.prefs); " +
"$this.reparse.last_search=$this.reparse.cur_search},this.reparse.delay)}else this.g_unhook()},g_hook:function(a,b){if(!this.g_hooked){var c=this.doc.getElementById(\"lst-ib\");if(c)this.reparse.host=a,this.reparse.rules_str=b,this.reparse.last_search=c.value,addListener(c,\"keyup\",this,!0);this.g_hooked=!0}},g_unhook:function(){var a=this.doc.getElementById(\"lst-ib\");a&&addListener(a,\"keyup\",this,!0);this.g_hooked=!1},post_hook:function(){var a=document.forms;if(a)for(var b=this,c=0,d=a.length;c<d;++c){var e= " +
"a[c];e.method==\"post\"&&addListener(e,\"submit\",function(a){for(var a=a.currentTarget,c=document.evaluate(\".//input[@type=\'text\']\",a,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),d={},e=0,i=c.snapshotLength;e<i;++e){var h=c.snapshotItem(e);b.logger.debug(h.name+\" \"+h.value);d[h.name]=h.value}b.extension_call(\"on_form_post\",a.name,d)},!1)}},is_post_hook_enabled:function(){return typeof document.evaluate!=\"undefined\"&&typeof XPathResult!=\"undefined\"},is_google_patch_enabled:function(){return typeof this.prefs[$pg_namespace.STG_KEY.GOOGLE_PATCH]!= " +
"\"undefined\"&&this.prefs[$pg_namespace.STG_KEY.GOOGLE_PATCH]},parse:function(a,b,c){var d={success:!1,params:\"\"};try{this.prefs=c;var e=conduitPage.JSON.parse(b);this.is_google_patch_enabled()&&e[\"@name\"].indexOf(\"google\")==0&&this.g_hook(a,b);var f=new $pg_namespace.site_matcher(this.doc,null,e);if(f.exec())d.success=!0,d.params=f.get_value()}catch(g){}if(!this.reparse.is_on||this.reparse.last_result.params!=d.params)this.reparse.last_result=d,this.extension_call(\"on_page_parse_done\",d)},extension_call:function(){for(var a= " +
"Array.prototype.shift.call(arguments),b=[],c=0,d=arguments.length;c<d;++c)b.push(arguments[c]);a=conduitPage.JSON.stringify({method:a,tid:this.page_tab_id,args:b});conduitPage.sendRequest(\"msg_to_bg\",a)},handle_message:function(a){a=typeof a==\"string\"?conduitPage.JSON.parse($pg_namespace.hex2str(a)):a;try{this[a.method]&&this[a.method].apply(this,a.args)}catch(b){}},on_message:function(a){return function(b){a.handle_message(b)}}}; " +
"var pg_wait_loaded=function(){if(typeof window.$pg_namespace==\"object\"&&typeof conduitPage==\"object\"){if(typeof $pg_namespace.doc_agent==\"undefined\")$pg_namespace.doc_agent=new $pg_namespace.page_handler(document)}else window.setTimeout(pg_wait_loaded,200)};pg_wait_loaded(); " +
"";

function xml2json(a){var b={toObj:function(a){var c={};if(a.nodeType==1){if(a.attributes.length)for(var e=0;e<a.attributes.length;e++)c["@"+a.attributes[e].nodeName]=b.escape((a.attributes[e].nodeValue||"").toString());if(a.firstChild){for(var h=e=0,g=!1,f=a.firstChild;f;f=f.nextSibling)f.nodeType==1?g=!0:f.nodeType==3&&f.nodeValue.match(/[^ \f\n\r\t\v]/)?e++:f.nodeType==4&&h++;if(g)if(e<2&&h<2){b.removeWhite(a);for(f=a.firstChild;f;f=f.nextSibling)f.nodeType==3?c["#text"]=b.escape(f.nodeValue):f.nodeType==
4?c["#cdata"]=b.escape(f.nodeValue):c[f.nodeName]?c[f.nodeName]instanceof Array?c[f.nodeName][c[f.nodeName].length]=b.toObj(f):c[f.nodeName]=[c[f.nodeName],b.toObj(f)]:c[f.nodeName]=b.toObj(f)}else a.attributes.length?c["#text"]=b.escape(b.innerXml(a)):c=b.escape(b.innerXml(a));else if(e)a.attributes.length?c["#text"]=b.escape(b.innerXml(a)):c=b.escape(b.innerXml(a));else if(h)if(h>1)c=b.escape(b.innerXml(a));else for(f=a.firstChild;f;f=f.nextSibling)c["#cdata"]=b.escape(f.nodeValue)}!a.attributes.length&&
!a.firstChild&&(c=null)}else a.nodeType==9&&(c=b.toObj(a.documentElement));return c},toJson:function(a,c,e){var h=c?'"'+c+'"':"";if(a instanceof Array){for(var g=0,f=a.length;g<f;g++)a[g]=b.toJson(a[g],"",e+"\t");h+=(c?":[":"[")+(a.length>1?"\n"+e+"\t"+a.join(",\n"+e+"\t")+"\n"+e:a.join(""))+"]"}else if(a==null)h+=(c&&":")+"null";else if(typeof a=="object"){g=[];for(f in a)g[g.length]=b.toJson(a[f],f,e+"\t");h+=(c?":{":"{")+(g.length>1?"\n"+e+"\t"+g.join(",\n"+e+"\t")+"\n"+e:g.join(""))+"}"}else h+=
typeof a=="string"?(c&&":")+'"'+a.toString()+'"':(c&&":")+a.toString();return h},innerXml:function(a){var b="";if("innerHTML"in a)b=a.innerHTML;else for(var e=function(a){var b="";if(a.nodeType==1){b+="<"+a.nodeName;for(var c=0;c<a.attributes.length;c++)b+=" "+a.attributes[c].nodeName+'="'+(a.attributes[c].nodeValue||"").toString()+'"';if(a.firstChild){b+=">";for(c=a.firstChild;c;c=c.nextSibling)b+=e(c);b+="</"+a.nodeName+">"}else b+="/>"}else a.nodeType==3?b+=a.nodeValue:a.nodeType==4&&(b+="<![CDATA["+
a.nodeValue+"]]\>");return b},a=a.firstChild;a;a=a.nextSibling)b+=e(a);return b},escape:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(a){a.normalize();for(var c=a.firstChild;c;)if(c.nodeType==3)if(c.nodeValue.match(/[^ \f\n\r\t\v]/))c=c.nextSibling;else{var e=c.nextSibling;a.removeChild(c);c=e}else c.nodeType==1&&b.removeWhite(c),c=c.nextSibling;return a}};if(a.nodeType==9)a=a.documentElement;return b.toObj(b.removeWhite(a))}
var DEF_EXT_VERSION="6.6.9",DEF_DIS_ID="cndtsb",DEF_SUB_DIS_ID="-",DEF_POST_INSTALL_URL="",$pg_namespace={PG_BASE_URL:"http://smartbar.pricegong.com",INJECTED_PATH:"",BROWSER_API_URL:"../browserAppApi.js",OFFERS_FILE_PATH:"/offers/offers.html",WHITE_LISTS_PATH:"/SiteXMLFolder",TOOLBAR_DLG_PATH:"menu_dlg/pg_dlg.html",AGREEMENT_DLG_PATH:"agreement/agree.html",global_msg_key:"pg_global_msg_key",extension_msg_key:"pg_ext_msg_key",offers_msg_key:"pg_offers_msg_key",agreement_msg_key:"pg_agreement_msg_key",
preferences:{PG_LOGGING:!0,PG_LOCAL_HOST:"pgcff.pricegong.com"},SITE_TYPE_SEARCH_ENGINE:1,SITE_TYPE_ECOMMERCE:2,SITE_TYPE_TRAVEL:4,SITE_TYPE_CONDUIT_SE:8,DEFAULT_SITE_TYPE:0,IMPR_TYPE_URL_INVESTIGATION:1,IMPR_TYPE_RESULTS_PAGE_LINK:2,IMPR_TYPE_PRODUCT_PAGE:4,IMPR_TYPE_PRODUCT_PAGE_LINK:8,DEFAULT_IMPR_TYPE:0,SERVICE_TYPE_SHOPPING:1,SERVICE_TYPE_COUPONS:2,SERVICE_TYPE_TRAVEL:4,SERVICE_TYPE_COUPONS_HP:8,DEFAULT_SERVICE_TYPE:0,CATALOG_TYPE_XML:1,CATALOG_TYPE_WL:2,DEFAULT_CATALOG_TYPE:0,DEFAULT_UPGRADE_INFO:{new_ver:"0.0.0",
url:"",span:0,has_new_version:!1},DEFAULT_CLIENT_VERSION:DEF_EXT_VERSION,DEFAULT_USER_GROUP:"",DEFAULT_GOOGLE_PATCH:!0,STG_KEY:{SERVER_LOCATION:"pg_server_location",SETTINGS_URL:"pg_settings_url",LAST_SETTINGS_UPDATE:"pg_last_settings_update",FIRST_RUN:"pg_first_run",FIRST_RUN_TIME:"pg_first_run_time",MACHINE_ID:"pg_machine_id",USER_ID:"pg_user_id",SNOOZE_TIME:"pg_snooze_time",IS_ENABLED:"pg_is_enabled",COUNTRY_CODE:"pg_country_code",LAST_UPGRADE_DISPLAY:"pg_last_upgrade_disp",CATALOG_TYPE:"pg_catalog_type",
CATALOG_MODE:"pg_catalog_mode",CX_SERVER_LOCATION:"pg_cx_server",SETTINGS_UPDATE_INTERVAL:"pg_settings_update_interval",USER_GROUP:"pg_user_group",ACTIVE_SITE_TYPES:"pg_active_site_types",OFFERS_URL:"pg_offers_url",IMPR_TYPE:"pg_impr_type",EXTRA_PARAMS:"pg_extra_params",UPGRADE_INFO:"pg_upgrade_info",CLIENT_VERSION:"pg_client_ver",XML_CATALOGS_URL:"pg_xml_catalogs_url",WL_CATALOGS_URL:"pg_wl_catalogs_url",USER_AGREE:"pg_user_agree",DIST_ID:"pg_dist_id",SUB_DIST_ID:"pg_sub_dist_id",GOOGLE_PATCH:"pg_google_patch",
OPT_ENABLE_SEARCH_ENGINES:"pg_enable_search_engines",OPT_ENABLE_ECOMM_SEARCH:"pg_enable_ecomm_search",POST_INSTALL_ACTION:"pg_post_install_action"},POST_INSTALL_URL:DEF_POST_INSTALL_URL,SNOOZE_MIN_MINUTES:0,SNOOZE_MAX_MINUTES:2880,PAGE_STATE_CREATED:"created",PAGE_STATE_LOADING:"loading",PAGE_STATE_LOADED:"loaded",PAGE_STATE_INIT:"init",PAGE_STATE_READY:"ready",PAGE_STATE_PARSING:"parsing",PAGE_STATE_PARSING_DONE:"parsing_done",PG_EXT_GUID:"{8A9386B4-E958-4c4c-ADF4-8F26DB3E4829}",gen_machine_id:function(){return $pg_namespace.num2hex(Math.random()*
4294967295+1,8)+"-"+$pg_namespace.num2hex(Math.random()*4294967295+1,8)+$pg_namespace.num2hex(Math.random()*65535+1,4)},gen_uuid:function(){return $pg_namespace.num2hex(Math.random()*4294967295+1,8)+"-"+$pg_namespace.num2hex(Math.random()*65535+1,4)+"-"+$pg_namespace.num2hex(Math.random()*65535+1,4)+"-"+$pg_namespace.num2hex(Math.random()*65535+1,4)+"-"+$pg_namespace.num2hex(Math.random()*4294967295+1,8)+$pg_namespace.num2hex(Math.random()*65535+1,4)},pg_date_format:function(a){return a.getUTCDate()+
"-"+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a.getMonth()]+"-"+a.getUTCFullYear()+" "+a.getUTCHours()+":"+a.getUTCMinutes()+":"+a.getUTCSeconds()},loc_from_url:function(a){var b=document.createElement("a");b.href=a;return b},get_url_query_params:function(a){for(var b={},a=$pg_namespace.loc_from_url(a).search.substring(1).split("&"),d=0,c=a.length;d<c;++d){var e=a[d].split("="),h=e.length>1?e[1]:"";b[$pg_namespace.decodeURI(e[0])]=$pg_namespace.decodeURI(h)}return b},
escape:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[']/g,"\\'").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},unescape:function(a){return a.replace(/\\\\/g,"\\").replace(/\\\"/g,'"').replace(/\\\'/g,"'").replace(/\\n/g,"\n").replace(/\\r/g,"\r")},extend:function(a,b){for(var d in b.prototype)typeof a.prototype[d]=="undefined"&&(a.prototype[d]=b.prototype[d]);return a},kv_pairs_from_str:function(a){for(var b=/([^\/?&]+)={1}([^\/?&]+)|([^\/?&]+):{1}([^\/?&]+)|([^\/?&]+)-{1}([^\/?&]+)/g,
d={},c;(c=b.exec(a))!=null;){for(var e=1,h=c.length;e<h&&c[e]==void 0;)e+=2;e<h-1&&(d[c[e]]=c[e+1])}return d},find_value:function(a,b){var d=a.match(RegExp("(^|[/?&])"+b+"([^/?&]+)","i"));return d?d[2]:null},german_accents:"\u00c4\u00e4\u00d6\u00f6\u00dc\u00fc\u00df\u20ac",french_accents:"\u00c0\u00c2\u00c4\u00c8\u00c9\u00ca\u00cb\u00ce\u00cf\u00d4\u0152\u00d9\u00db\u00dc\u0178\u00e0\u00e2\u00e4\u00e8\u00e9\u00ea\u00eb\u00ee\u00ef\u00f4\u0153\u00f9\u00fb\u00fc\u00ff",italian_accents:"\u00c0\u00c8\u00c9\u00cc\u00d2\u00d3\u00d9\u00e0\u00e8\u00e9\u00ec\u00f2\u00f3\u00f9",
spanish_accents:"\u00c1\u00c9\u00cd\u00d3\u00da\u00d1\u00dc\u00e1\u00e9\u00ed\u00f3\u00fa\u00f1\u00fc",all_accents:"\u00c4\u00e4\u00d6\u00f6\u00dc\u00fc\u00df\u20ac\u00c0\u00c2\u00c8\u00c9\u00ca\u00cb\u00ce\u00cf\u00d4\u0152\u00d9\u00db\u0178\u00e0\u00e2\u00e8\u00e9\u00ea\u00eb\u00ee\u00ef\u00f4\u0153\u00f9\u00fb\u00ff\u00cc\u00d2\u00d3\u00ec\u00f2\u00f3\u00c1\u00cd\u00da\u00d1\u00e1\u00ed\u00fa\u00f1",decode_reg_exp:function(a){var a=a.replace(/\\\]/g,"$hide_it_ti_edih$"),b=a.match(/(\[[^\]]*\[[^\]]*\][^\]]*\])/g);
if(b)for(var d=0,c=b.length;d<c;++d)a=a.replace(b[d],b[d].replace(/\][^$]/,"\\]"));a=a.replace("$hide_it_ti_edih$","\\]");b=$pg_namespace;return a.replace("~G~",b.german_accents).replace("~F~",b.french_accents).replace("~I~",b.italian_accents).replace("~S~",b.spanish_accents).replace("~A~",b.all_accents)},unique:function(a){for(var b="",d=0,c=a.length;d<c;++d){var e=a.charAt(d);-1==b.search(RegExp(e))&&(b+=e)}return b},chars2codes:function(a){for(var b="",d=0,c=a.length;d<c;++d)b=b+"\\u"+$pg_namespace.num2hex(a.charCodeAt(d),
4);return b},num2hex:function(a,b){a=Math.round(a);b=Math.round(b);a<0&&(a=4294967295+a+1);for(var d=a.toString(16),b=typeof b=="number"&&b>=0?b:4,c=d.length;c<b;++c)d="0"+d;return d},pack_msg_params:function(){for(var a=Array.prototype.shift.call(arguments),b=[],d=0,c=arguments.length;d<c;++d)b.push(arguments[d]);return{method:a,args:b}},encodeURIComponent:function(a){return encodeURIComponent(a).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")},
decodeURI:function(a){try{return decodeURI(a)}catch(b){}try{return unescape(a)}catch(d){}return a},encode:function(a){if(typeof a!="string")return a;for(var b="",d=0,c=a.length;d<c;++d){var e=(d+1)%95,h=a.charCodeAt(d);h>=32&&h<=126&&(h=126-(h-32)+e,h=h<=126?h:32+(h-126-1));b+=String.fromCharCode(h)}return b},decode:function(a){if(typeof a!="string")return a;for(var b="",d=0,c=a.length;d<c;++d){var e=(d+1)%95,h=a.charCodeAt(d);h>=32&&h<=126&&(e=h-e,h=127-(e>=32?e-32:95-(32-e))-1);b+=String.fromCharCode(h)}return b},
add_class:function(a,b){var d=a.className.split(/\s+/),b=b.toLowerCase();if(!d.some(function(a){return a==b}))d.push(b),a.className=d.join(" ")},remove_class:function(a,b){var d=a.className.split(/\s+/),b=b.toLowerCase();d.forEach(function(c,e){if(c.toLowerCase()==b)d.splice(e,1),a.className=d.join(" ")})},has_class:function(a,b){var d=a.className.split(/\s+/),b=b.toLowerCase();return d.some(function(a){return a==b})},str2hex:function(a){if(typeof a!="string")return a;for(var b="",d=0,c=a.length;d<
c;++d){var e=a.charCodeAt(d).toString(16);e.length<2&&(e="0"+e);b+=e}return b},hex2str:function(a){if(typeof a!="string")return a;for(var b="",d=0,c=a.length;d<c;d+=2){var e=a.substr(d,2);b+=String.fromCharCode(parseInt(e,16))}return b},jsonstr:function(a){return JSON.stringify(a,null," ")}};$pg_namespace.pg_ext_inst=$pg_namespace.num2hex(Math.random()*4294967295+1,8);$pg_namespace.extension_msg_key=$pg_namespace.extension_msg_key+"_"+$pg_namespace.pg_ext_inst;$pg_namespace.DEFAULT_SITE_TYPE=$pg_namespace.SITE_TYPE_ECOMMERCE;
$pg_namespace.DEFAULT_IMPR_TYPE=$pg_namespace.IMPR_TYPE_PRODUCT_PAGE|$pg_namespace.IMPR_TYPE_URL_INVESTIGATION;$pg_namespace.DEFAULT_SERVICE_TYPE=$pg_namespace.SERVICE_TYPE_SHOPPING;$pg_namespace.DEFAULT_CATALOG_TYPE=$pg_namespace.CATALOG_TYPE_WL;$pg_namespace.logger=function(){return{init:function(){},debug:function(){},error:function(){}}}();if(typeof $pg_logging==="undefined")var $pg_logging=$pg_namespace.preferences.PG_LOGGING;if(typeof $pg_release_build==="undefined")var $pg_release_build=!1;
var pgLog;
pg_conf=function(){var a=function(a){if(typeof a!="string")return a;for(var b="",d=0,g=a.length;d<g;++d){var f=(d+1)%95,i=a.charCodeAt(d);i>=32&&i<=126&&(i=126-(i-32)+f,i=i<=126?i:32+(i-126-1));b+=String.fromCharCode(i)}return b},b=function(a){if(typeof a!="string")return a;for(var b="",d=0,g=a.length;d<g;++d){var f=(d+1)%95,i=a.charCodeAt(d);i>=32&&i<=126&&(f=i-f,i=127-(f>=32?f-32:95-(32-f))-1);b+=String.fromCharCode(i)}return b},d=function(a,b,d,g,f){this.storage=g;this.set=a;this.get=b;this.del=
d;this.master_key="pg_conf_"+f;this.cache={}};d.prototype={init:function(a){this.refresh(a)},refresh:function(a){this.storage.get(this.master_key,this.refresh_success(a),this.refresh_failure(a))},commit:function(){$this=this;this.storage.set(this.master_key,a(JSON.stringify(this.cache)),function(){},function(){})},refresh_success:function(a){var d=this;return function(h){try{if(h)d.cache=JSON.parse(b(h))}catch(g){d.storage.remove(d.master_key);return}a()}},refresh_failure:function(a){return function(){a()}},
set_str:function(a,b){this.set(a,b)},get_str:function(a,b){var d=this.get(a);d==null&&(d=b);return d},set_int:function(a,b){this.set(a,b)},get_int:function(a,b){var d=this.get(a);d==null&&(d=b);return parseInt(d)},set_bool:function(a,b){this.set(a,b)},get_bool:function(a,b){var d=this.get(a);if(d==null)return b;return d=="true"||d==!0},set_obj:function(a,b){try{this.set_str(a,JSON.stringify(b))}catch(d){}},get_obj:function(a,b){var d=this.get(a);if(d==null)return b;try{return JSON.parse(d)}catch(g){}return b}};
return{init:function(a){a=this.init_cb(a);this.global.init(a);this.local.init(a)},init_cb:function(a){var b=2;return function(){b-=1;b==0&&a()}},global:new d(function(a,b,d){this.cache[a]=b;d||this.commit()},function(a){if(a in this.cache)return this.cache[a];return null},function(a,b){delete this.cache[a];b||this.commit()},conduit.storage.global.items,"global"),local:new d(function(a,b,d){this.cache[a]=b;d||this.commit()},function(a){if(a in this.cache)return this.cache[a];return null},function(a,
b){delete this.cache[a];b||this.commit()},conduit.storage.app.items,"local")}}();
var pg_instance=function(){var a=$pg_namespace;return{set_enabled:function(b){pg_conf.global.set_bool(a.STG_KEY.IS_ENABLED,b.toString());b&&this.set_snooze_time(0)},is_enabled:function(){if(pg_settings.MANAGED_APP_MODE==2)return!0;return pg_conf.global.get_bool(a.STG_KEY.IS_ENABLED,!0)},is_active_ignore_mam:function(){return pg_conf.global.get_bool(a.STG_KEY.IS_ENABLED,!0)&&pg_conf.global.get_bool(a.STG_KEY.USER_AGREE,!0)},is_active:function(){return this.is_enabled()&&this.get_user_agree()&&!this.is_snoozing()},
is_first_run:function(){return pg_conf.global.get_bool(a.STG_KEY.FIRST_RUN,!0)},set_first_run:function(b){pg_conf.global.set_bool(a.STG_KEY.FIRST_RUN,b);b&&(b=$pg_namespace.pg_date_format(new Date),pg_conf.global.set_str(a.STG_KEY.FIRST_RUN_TIME,b))},reset_first_run:function(){for(key in a.STG_KEY)pg_conf.global.del(a.STG_KEY[key])},get_first_run_time:function(){this.is_first_run();return pg_conf.global.get_str(a.STG_KEY.FIRST_RUN_TIME,"")},set_first_run_time:function(b){pg_conf.global.set_str(a.STG_KEY.FIRST_RUN_TIME,
b)},get_user_agree:function(){return pg_conf.global.get_bool(a.STG_KEY.USER_AGREE,!1)},set_user_agree:function(b){pg_conf.global.set_bool(a.STG_KEY.USER_AGREE,b)},get_post_install_action:function(){return pg_conf.global.get_bool(a.STG_KEY.POST_INSTALL_ACTION,!0)},set_post_install_action:function(b){pg_conf.global.set_bool(a.STG_KEY.POST_INSTALL_ACTION,b)},is_agreement_set:function(){return pg_conf.global.get_bool(a.STG_KEY.USER_AGREE,null)!==null},get_machine_id:function(){var b=pg_conf.global.get_str(a.STG_KEY.MACHINE_ID,
"");b.length==0&&(b=$pg_namespace.gen_machine_id(),pg_conf.global.set_str(a.STG_KEY.MACHINE_ID,b));return b},get_user_id:function(){var b=pg_conf.global.get_str(a.STG_KEY.USER_ID,"");b.length==0&&(b=$pg_namespace.gen_uuid(),pg_conf.global.set_str(a.STG_KEY.USER_ID,b));return b},get_dist_id:function(){return pg_settings.DISTRIBUTER_ID},get_sub_dist_id:function(){return pg_settings.SUB_DISTRIBUTER_ID},set_sub_dist_id:function(a){pg_settings.SUB_DISTRIBUTER_ID=a},get_toolbar_name:function(){return pg_settings.TOOLBAR_NAME},
set_toolbar_name:function(a){pg_settings.TOOLBAR_NAME=a},set_toolbar_version:function(a){pg_settings.TOOLBAR_VERSION=a},get_browser_type:function(){return pg_settings.BROWSER_TYPE},set_browser_type:function(a){try{if(a=="IE")pg_settings.BROWSER_TYPE="ie",pg_settings.PG_EXT_GUID="{1631550F-191D-4826-B069-D9439253D926}";else if(a=="Firefox")pg_settings.BROWSER_TYPE="ff",pg_settings.PG_EXT_GUID="{8A9386B4-E958-4c4c-ADF4-8F26DB3E4829}";else if(a=="Chrome")pg_settings.BROWSER_TYPE="ch",pg_settings.PG_EXT_GUID=
"bkomkajifikmkfnjgphkjcfeepbnojok"}catch(d){}},set_browser_version:function(a){pg_settings.BROWSER_VERSION=a},set_os_version:function(a){pg_settings.OS=a},get_extension_guid:function(){return pg_settings.PG_EXT_GUID},is_snoozing:function(){return this.get_snooze_time()>(new Date).valueOf()},set_snooze_time:function(b){pg_conf.global.set_int(a.STG_KEY.SNOOZE_TIME,(new Date).valueOf()+b)},get_snooze_time:function(){return pg_conf.global.get_int(a.STG_KEY.SNOOZE_TIME,0)},platform_info:function(){},set_country_code:function(b){pg_conf.global.set_str(a.STG_KEY.COUNTRY_CODE,
b)},get_country_code:function(){return pg_conf.global.get_str(a.STG_KEY.COUNTRY_CODE,"")},set_last_settings_update:function(b){pg_conf.global.set_int(a.STG_KEY.LAST_SETTINGS_UPDATE,b)},get_last_settings_update:function(){return pg_conf.global.get_int(a.STG_KEY.LAST_SETTINGS_UPDATE,0)},set_settings_update_interval:function(b){pg_conf.global.set_int(a.STG_KEY.SETTINGS_UPDATE_INTERVAL,b)},get_settings_update_interval:function(){return pg_conf.global.get_int(a.STG_KEY.SETTINGS_UPDATE_INTERVAL,pg_settings.DEFAULT_SETTINGS_FILE_UPDATE_INTERVAL)},
set_catalog_type:function(b){if(b!=a.CATALOG_TYPE_XML&&b!=a.CATALOG_TYPE_WL)b=a.DEFAULT_CATALOG_TYPE;pg_conf.global.set_int(a.STG_KEY.CATALOG_TYPE,b)},get_catalog_type:function(){return pg_conf.global.get_int(a.STG_KEY.CATALOG_TYPE,a.DEFAULT_CATALOG_TYPE)},set_xml_catalogs_url:function(b){pg_conf.global.set_str(a.STG_KEY.XML_CATALOGS_URL,b)},get_xml_catalogs_url:function(){return pg_conf.global.get_str(a.STG_KEY.XML_CATALOGS_URL,"")},set_wl_catalogs_url:function(b){pg_conf.global.set_str(a.STG_KEY.WL_CATALOGS_URL,
b)},get_wl_catalogs_url:function(){return pg_conf.global.get_str(a.STG_KEY.WL_CATALOGS_URL,"")},set_cx_server_location:function(b){pg_conf.global.set_str(a.STG_KEY.CX_SERVER_LOCATION,b)},get_cx_server_location:function(){return pg_conf.global.get_str(a.STG_KEY.CX_SERVER_LOCATION,pg_settings.DEFAULT_CX_URL)},set_offers_url:function(b){pg_conf.global.set_str(a.STG_KEY.OFFERS_URL,b)},get_offers_url:function(){return pg_conf.global.get_str(a.STG_KEY.OFFERS_URL,pg_settings.DEFAULT_OFFERS_URL)},set_user_group:function(b){pg_conf.global.set_str(a.STG_KEY.USER_GROUP,
b)},get_user_group:function(){return pg_conf.global.get_str(a.STG_KEY.USER_GROUP,a.DEFAULT_USER_GROUP)},set_active_site_types:function(b){pg_conf.global.set_int(a.STG_KEY.ACTIVE_SITE_TYPES,b)},get_active_site_types:function(){return pg_conf.global.get_int(a.STG_KEY.ACTIVE_SITE_TYPES,pg_settings.DEFAULT_ACTIVE_SITE_TYPES)},get_effective_active_site_types:function(){var a=this.get_active_site_types();this.get_search_engine_enabled()||(a&=~($pg_namespace.SITE_TYPE_CONDUIT_SE|$pg_namespace.SITE_TYPE_SEARCH_ENGINE));
return a},set_settings_url:function(b){pg_conf.global.set_str(a.STG_KEY.SETTINGS_URL,b)},get_settings_url:function(){return pg_conf.global.get_str(a.STG_KEY.SETTINGS_URL,pg_settings.SETTINGS_FILE_URL)},set_impr_type:function(b){pg_conf.global.set_int(a.STG_KEY.IMPR_TYPE,b)},get_impr_type:function(){return pg_conf.global.get_int(a.STG_KEY.IMPR_TYPE,a.DEFAULT_IMPR_TYPE)},get_effective_impr_type:function(){var a=this.get_impr_type();pg_instance.get_ecom_search_enabled()||(a&=~$pg_namespace.IMPR_TYPE_URL_INVESTIGATION);
return a},set_extra_params:function(b){pg_conf.global.set_obj(a.STG_KEY.EXTRA_PARAMS,b)},get_extra_params:function(){return pg_conf.global.get_obj(a.STG_KEY.EXTRA_PARAMS,[])},set_last_upgrade_display:function(b){pg_conf.global.set_int(a.STG_KEY.LAST_UPGRADE_DISPLAY,b)},get_last_upgrade_display:function(){return pg_conf.global.get_int(a.STG_KEY.LAST_UPGRADE_DISPLAY,0)},set_upgrade_info:function(b){pg_conf.global.set_obj(a.STG_KEY.UPGRADE_INFO,b)},get_upgrade_info:function(){return pg_conf.global.get_obj(a.STG_KEY.UPGRADE_INFO,
a.DEFAULT_UPGRADE_INFO)},should_display_upgrade_notification:function(){var a=pg_instance.get_last_upgrade_display(),d=pg_instance.get_upgrade_info();return pg_instance.is_enabled()&&d.has_new_version&&a+d.span<(new Date).valueOf()},set_client_version:function(b){pg_conf.global.set_str(a.STG_KEY.CLIENT_VERSION,b)},get_client_version:function(){return pg_conf.global.get_str(a.STG_KEY.CLIENT_VERSION,a.DEFAULT_CLIENT_VERSION)},set_google_patch:function(b){pg_conf.global.set_bool(a.STG_KEY.GOOGLE_PATCH,
b?!0:!1)},get_google_patch:function(){return pg_conf.global.get_bool(a.STG_KEY.GOOGLE_PATCH,a.DEFAULT_GOOGLE_PATCH)},set_search_engine_enabled:function(b){pg_conf.global.set_bool(a.STG_KEY.OPT_ENABLE_SEARCH_ENGINES,b)},get_search_engine_enabled:function(){return pg_conf.global.get_bool(a.STG_KEY.OPT_ENABLE_SEARCH_ENGINES,!0)},set_ecom_search_enabled:function(b){pg_conf.global.set_bool(a.STG_KEY.OPT_ENABLE_ECOMM_SEARCH,b)},get_ecom_search_enabled:function(){return pg_conf.global.get_bool(a.STG_KEY.OPT_ENABLE_ECOMM_SEARCH,
!0)},get_prefs:function(){var b={};b[a.STG_KEY.FIRST_RUN]=this.is_first_run();b[a.STG_KEY.FIRST_RUN_TIME]=this.get_first_run_time();b[a.STG_KEY.MACHINE_ID]=this.get_machine_id();b[a.STG_KEY.USER_ID]=this.get_user_id();b[a.STG_KEY.SNOOZE_TIME]=this.get_snooze_time();b[a.STG_KEY.IS_ENABLED]=this.is_enabled();b[a.STG_KEY.USER_GROUP]=this.get_user_group();b[a.STG_KEY.SETTINGS_UPDATE_INTERVAL]=this.get_settings_update_interval();b[a.STG_KEY.OFFERS_URL]=this.get_offers_url();b[a.STG_KEY.CX_SERVER_LOCATION]=
this.get_cx_server_location();b[a.STG_KEY.LAST_SETTINGS_UPDATE]=this.get_last_settings_update();b[a.STG_KEY.SETTINGS_UPDATE_INTERVAL]=this.get_settings_update_interval();b[a.STG_KEY.SETTINGS_URL]=this.get_settings_url();b[a.STG_KEY.CATALOG_TYPE]=this.get_catalog_type();b[a.STG_KEY.COUNTRY_CODE]=this.get_country_code();b[a.STG_KEY.WL_CATALOGS_URL]=this.get_wl_catalogs_url();b[a.STG_KEY.XML_CATALOGS_URL]=this.get_xml_catalogs_url();b[a.STG_KEY.IMPR_TYPE]=this.get_impr_type();b[a.STG_KEY.ACTIVE_SITE_TYPES]=
this.get_active_site_types();b[a.STG_KEY.CLIENT_VERSION]=this.get_client_version();b[a.STG_KEY.DIST_ID]=this.get_dist_id();b[a.STG_KEY.SUB_DIST_ID]=this.get_sub_dist_id();b[a.STG_KEY.GOOGLE_PATCH]=this.get_google_patch();return b},get_query_params:function(){var a={ext_type:1};a.bt=this.get_browser_type();a.bv=pg_settings.BROWSER_VERSION;a.os=pg_settings.OS;a.defbt="";a.pver=pg_settings.PROTOCOL_VERSION;a.app=pg_settings.APP_NAME;a.cver=this.get_client_version();a.pglv=pg_settings.LOADER_VERSION;
a.cnum=this.get_machine_id();a.unum=this.get_user_id();a.disid=this.get_dist_id();a.subdisid=this.get_sub_dist_id();a.tbn=this.get_toolbar_name();a.tbv=pg_settings.TOOLBAR_VERSION;a.cdate=this.get_first_run_time();a.ct=this.get_country_code();a.ug=this.get_user_group();a.inst=this.is_first_run()?1:0;a.ts=pg_catalogger.get_timestamp();a.snz=this.is_snoozing()?1:0;a.zs=pg_settings.SUPPORTS_ZIP;a.cxt=this.get_catalog_type();a.ctype=pg_settings.MANAGED_APP_MODE>0?"mam"+pg_settings.MANAGED_APP_MODE:0;
for(var d=this.get_extra_params(),c=0,e=d.length;c<e;++c){var h=d[c];a[h.key]=h.value}return a},make_offers_url:function(a){var d=this.get_query_params();/(^|&)impr=/.test(a)&&"impr"in d&&delete d.impr;var c=[],e;for(e in d)c.push(e+"="+$pg_namespace.encodeURIComponent(d[e]));return this.get_offers_url()+"?"+c.join("&")+(c.length>0?"&":"")+a},apply_settings:function(a){pg_instance.set_catalog_type(a.cxt);pg_instance.set_cx_server_location(a.cx_server_location);pg_instance.set_offers_url(a.s_url);
pg_instance.set_settings_update_interval(a.cfg_interval);pg_instance.set_user_group(a.group);pg_instance.set_active_site_types(a.active_site_type);pg_instance.set_impr_type(a.impr_type);pg_instance.set_extra_params(a.request_extra_params);pg_instance.set_upgrade_info(a.upgrade_info);pg_instance.set_google_patch(a.google_patch)}}}(),pg_settings={SETTINGS_FILE_URL:"http://settings.pricegong.com/settings.ashx",DEFAULT_OFFERS_URL:$pg_namespace.PG_BASE_URL+$pg_namespace.OFFERS_FILE_PATH,DEFAULT_CX_URL:$pg_namespace.PG_BASE_URL+
$pg_namespace.WHITE_LISTS_PATH,XML_FILE_KEY_PREFIX:"pg_xml_",XML_UPDATE_QUEUE_KEY:"pg_xml_update_queue",XML_UPDATE_TIMESTAMP_KEY:"pg_xml_update_ts",WL_FILE_KEY_PREFIX:"pg_wl_",WL_UPDATE_QUEUE_KEY:"pg_wl_update_queue",WL_UPDATE_TIMESTAMP_KEY:"pg_wl_update_ts",HOST_XML_RULES_KEY_PREFIX:"pg_xml_rule_",HOST_WL_RULES_KEY_PREFIX:"pg_wl_rule_",DEFAULT_OFFERS_URL:"http://service.pricegong.com/default.aspx",DEFAULT_SETTINGS_FILE_UPDATE_INTERVAL:288E5,DEFAULT_ACTIVE_SITE_TYPES:$pg_namespace.SERVICE_TYPE_SHOPPING|
$pg_namespace.SERVICE_TYPE_TRAVEL,DISTRIBUTER_ID:DEF_DIS_ID,SUB_DISTRIBUTER_ID:DEF_SUB_DIS_ID,TOOLBAR_NAME:"-",TOOLBAR_VERSION:0,MANAGED_APP_MODE:0,BROWSER_TYPE:"",BROWSER_VERSION:"unknown",OS:"",PG_EXT_GUID:-1,PROTOCOL_VERSION:1,APP_NAME:"pg_cndtsb",LOADER_VERSION:0,SUPPORTS_ZIP:0},pg_settings_manager=function(){var a=$pg_namespace,b=a.unescape,d=[],c=0,e=function(d){try{var c={},e=xml2json(d,"");c.cxt=a.CATALOG_TYPE_WL;"cxt"in e&&parseInt(e.cxt);c.sites_rules_files={timestamp:(new Date).valueOf()/
1E3,update_files:[],server_location:""};if("sites_rules_files"in e){if("@ts"in e.sites_rules_files)c.sites_rules_files.timestamp=parseInt(e.sites_rules_files["@ts"]);if("server_location"in e.sites_rules_files&&"#cdata"in e.sites_rules_files.server_location)c.sites_rules_files.server_location=e.sites_rules_files.server_location["#cdata"];if("file"in e.sites_rules_files){var f=e.sites_rules_files.file,d=function(a){var b=typeof a;if(b=="string")return a;if(b=="object"){if("#cdata"in a)return a["#cdata"];
if("#text"in a)return a["#text"]}return!1};if(f.constructor==Array)for(var g=0,t=f.length;g<t;++g){var i=d(f[g]);i!==!1&&c.sites_rules_files.update_files.push(i)}else i=d(f),i!==!1&&c.sites_rules_files.update_files.push(i)}}c.cx_server_location=pg_settings.DEFAULT_CX_URL;if("cx_server_location"in e&&"#cdata"in e.cx_server_location)c.cx_server_location=b(e.cx_server_location["#cdata"]);c.s_url=pg_settings.DEFAULT_OFFERS_URL;if("s_url"in e&&"#cdata"in e.s_url)c.s_url=b(e.s_url["#cdata"]);c.cfg_interval=
pg_settings.DEFAULT_SETTINGS_FILE_UPDATE_INTERVAL;if("cfg_interval"in e)c.cfg_interval=parseInt(e.cfg_interval)*36E5;c.group=a.DEFAULT_USER_GROUP;if("group"in e&&"#cdata"in e.group)c.group=b(e.group["#cdata"]);c.active_site_type=pg_settings.DEFAULT_ACTIVE_SITE_TYPES;if("active_site_type"in e&&"#cdata"in e.active_site_type)c.active_site_type=parseInt(b(e.active_site_type["#cdata"]));c.impr_type=a.DEFAULT_IMPR_TYPE;if("impr_type"in e&&"#cdata"in e.impr_type)c.impr_type=parseInt(e.impr_type["#cdata"]);
c.request_extra_params=[];if("request_extra_params"in e&&"item"in e.request_extra_params){f=[];g=0;for(t=e.request_extra_params.item.length;g<t;++g){var u=e.request_extra_params.item[g];f.push({key:u["@name"],value:u["@value"]})}c.request_extra_params=f}c.upgrade_info=a.DEFAULT_UPGRADE_INFO;if("upgrade_info"in e&&"new_ver"in e.upgrade_info&&"url"in e.upgrade_info&&"span"in e.upgrade_info){var l=e.upgrade_info.new_ver,p=e.upgrade_info.url,m=e.upgrade_info.span,l=typeof l=="object"&&"#cdata"in l?l["#cdata"]:
l,p=typeof p=="object"&&"#cdata"in p?p["#cdata"]:b(p),m=typeof m=="object"&&"#cdata"in m?m["#cdata"]:parseInt(m),q=pg_instance.get_upgrade_info();q.new_ver=l;q.url=p;q.span=m*36E5;q.has_new_version=h(pg_instance.get_client_version(),l)>0;c.upgrade_info=q}c.google_patch=a.DEFAULT_GOOGLE_PATCH;if("google_patch"in e)c.google_patch=parseInt(e.google_patch)?!0:!1;c.server_time="";if("servertime"in e)c.server_time=b(e.servertime["#cdata"])}catch(v){return!1}return c},h=function(a,b){for(var c=[0,0,0],d=
[0,0,0],a=a.split("."),b=b.split("."),e=0,f=a.length;e<f&&e<3;++e)c[e]=parseInt(a[e]);e=0;for(f=b.length;e<f&&e<3;++e)d[e]=parseInt(b[e]);for(e=0;e<3;++e){if(c[e]<d[e])return 1;if(c[e]>d[e])return-1}return 0},g=function(){var a=pg_instance.get_settings_update_interval(),b=(new Date).valueOf(),b=pg_instance.get_last_settings_update()+a-b;return b<0||b>a?0:b},f=function(){var a=pg_instance.get_query_params(),b=[],c;for(c in a)b.push(c+"="+$pg_namespace.encodeURIComponent(a[c]));a=pg_instance.get_settings_url()+
"?"+b.join("&");conduit.network.httpRequest({method:"GET",url:a},function(a,b,c){c={status:c,responseText:a,statusText:c==200?"OK":"Failed "+c.toString()};b=3E5;try{if(c.status==200){a=a.replace(/<\?xml[^?]+\?>/,"");a:{c=a;try{if(window.DOMParser){a=(new DOMParser).parseFromString(c,"text/xml");break a}else for(var n=["Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"];0<n.length;){var f=new ActiveXObject(n[0]);f.async=!1;f.loadXML(c);f.setProperty("SelectionLanguage","XPath");a=f;break a}}catch(h){}a=
null}var j=e(a);if(j){pg_instance.set_last_settings_update((new Date).valueOf());for(var b=g(),a=0,m=d.length;a<m;++a)d[a].on_settings_update(j)}}}catch(o){}i(b)},function(){})},i=function(a){c&&window.clearTimeout(c);c=window.setTimeout(f,a)};return{init:function(){i(g())},add_listener:function(a){this.remove_listener(a);d.push(a)},remove_listener:function(a){for(var b=0,c=d.length;b<c;++b)if(a===d[b]){d.splice(b,1);break}},reset:function(){pg_instance.set_last_settings_update(0);i(g())},reschedule:function(){i(g())}}}(),
pg_wl_catalogger=function(){var a=["AC","AD","AE","AERO","AF","AG","AI","AL","AM","AN","AO","AQ","AR","ARPA","AS","ASIA","AT","AU","AW","AX","AZ","BA","BB","BD","BE","BF","BG","BH","BI","BIZ","BJ","BM","BN","BO","BR","BS","BT","BV","BW","BY","BZ","CA","CAT","CC","CD","CF","CG","CH","CI","CK","CL","CM","CN","CO","COM","COOP","CR","CU","CV","CX","CY","CZ","DE","DJ","DK","DM","DO","DZ","EC","EDU","EE","EG","ER","ES","ET","EU","FI","FJ","FK","FM","FO","FR","GA","GB","GD","GE","GF","GG","GH","GI","GL",
"GM","GN","GOV","GP","GQ","GR","GS","GT","GU","GW","GY","HK","HM","HN","HR","HT","HU","ID","IE","IL","IM","IN","INFO","INT","IO","IQ","IR","IS","IT","JE","JM","JO","JOBS","JP","KE","KG","KH","KI","KM","KN","KP","KR","KW","KY","KZ","LA","LB","LC","LI","LK","LR","LS","LT","LU","LV","LY","MA","MC","MD","ME","MG","MH","MIL","MK","ML","MM","MN","MO","MOBI","MP","MQ","MR","MS","MT","MU","MUSEUM","MV","MW","MX","MY","MZ","NA","NAME","NC","NE","NET","NF","NG","NI","NL","NO","NP","NR","NU","NZ","OM","ORG",
"PA","PE","PF","PG","PH","PK","PL","PM","PN","PR","PRO","PS","PT","PW","PY","QA","RE","RO","RS","RU","RW","SA","SB","SC","SD","SE","SG","SH","SI","SJ","SK","SL","SM","SN","SO","SR","ST","SU","SV","SY","SZ","TC","TD","TEL","TF","TG","TH","TJ","TK","TL","TM","TN","TO","TP","TR","TRAVEL","TT","TV","TW","TZ","UA","UG","UK","US","UY","UZ","VA","VC","VE","VG","VI","VN","VU","WF","WS","XN--0ZWM56D","XN--11B5BS3A9AJ6G","XN--80AKHBYKNJ4F","XN--9T4B11YI5A","XN--DEBA0AD","XN--FIQS8S","XN--FIQZ9S","XN--FZC2C9E2C",
"XN--G6W251D","XN--HGBK6AJ7F53BBA","XN--HLCJ6AYA9ESC7A","XN--J6W193G","XN--JXALPDLP","XN--KGBECHTV","XN--KPRW13D","XN--KPRY57D","XN--MGBAAM7A8H","XN--MGBAYH7GPA","XN--MGBERP4A5D4AR","XN--O3CW4H","XN--P1AI","XN--PGBS0DH","XN--WGBH1C","XN--WGBL6A","XN--XKC2AL3HYE2A","XN--YGBI2AMMX","XN--ZCKZAH","YE","YT","ZA","ZM","ZW"],b=0,d=function(){for(var a=[1,"wlu.txt"],b="a".charCodeAt(0),c="z".charCodeAt(0);b<=c;++b)a.push(String.fromCharCode(b)+".txt");return a},c=function(a){a=a.toLowerCase().replace(/^www\./,
"");if(a=="")return!1;a=""+a.charAt(0);if(/[0-9]/.test(a))return"1.txt";if(/[a-z]/.test(a))return a+".txt";return!1},e=function(a){try{var b=pg_conf.global.get(a);if(b){var b=JSON.parse(b),c;for(c in b)pg_conf.global.del(pg_settings.HOST_WL_RULES_KEY_PREFIX+c,!0);pg_conf.global.commit()}}catch(d){}},h=function(a){var c=[pg_instance.get_wl_catalogs_url(),a].join("/");conduit.network.httpRequest({method:"GET",url:c},function(c,d,h){d={status:h,responseText:c,statusText:h==200?"OK":"Failed "+h.toString()};
c=!1;try{if(d.status==200){var g=$pg_namespace.decode(d.responseText),j;a:{d=!1;try{for(var l=g.split("\n"),d={},g=0,p=l.length;g<p;++g)if(l[g].length!=0){var m=l[g].split("=");m.length==2&&(d[m[0]]=m[1])}var q=pg_settings.WL_FILE_KEY_PREFIX+a;e(q);pg_conf.global.set(q,JSON.stringify(d),!0)}catch(v){j=!1;break a}j=d}c=!1!==j}}catch(w){}b+=c?0:1;j=f();l=j.files.indexOf(a);l!=-1&&(j.files.splice(l,1),i(j,!0));j.files.length&&(j=[0,5,30,60],window.setTimeout(o,1E3*j[Math.min(j.length-1,b)]));pg_conf.global.commit()},
function(){})},g=function(a,b){this.host=a;this.callback=b;this.init_wl_updates();this.reset();this.do_next()};g.prototype.init_wl_updates=function(){this.wl_updates={};var a=pg_conf.global.get(pg_settings.WL_FILE_KEY_PREFIX+"wlu.txt");if(a)this.wl_updates=JSON.parse(a)};g.prototype.reset=function(){this.rule=this.rule_json=this.wl=null;this.cat_file=c(this.host);this.next_step=this.get_wl};g.prototype.do_next=function(){this.next_step()};g.prototype.done=function(){this.rule_json||!this.next_host()?
window.setTimeout(function(a){return function(){a.callback(a.rule_json?{host:a.host,rules_str:a.rule_json}:!1)}}(this),0):this.do_next()};g.prototype.next_host=function(){var b=this.host.split(".");if(b.length>2&&(b.shift(),-1==a.indexOf(b[0].toUpperCase())))return this.host=b.join("."),this.reset(),!0;return!1};g.prototype.get_wl=function(){this.wl=JSON.parse(pg_conf.global.get(pg_settings.WL_FILE_KEY_PREFIX+this.cat_file));this.next_step=this.get_rule;this.do_next()};g.prototype.get_rule=function(){this.next_step=
this.done;var a=null;this.wl_updates&&this.host in this.wl_updates?(a=this.wl_updates[this.host],this.wl=this.wl_updates):this.wl&&this.host in this.wl&&(a=this.wl[this.host]);if(a)if(this.rule_json=pg_conf.global.get(pg_settings.HOST_WL_RULES_KEY_PREFIX+this.host)){a=this.rule_json.replace(/[\\]{1}\'/,"\\\\'");this.rule=JSON.parse(a);a=(new Date).valueOf();"@last_check"in this.rule||(this.rule["@last_check"]=0);"@last_modified"in this.rule||(this.rule["@last_modified"]=a);var b="@ttl"in this.rule?
parseInt(this.rule["@ttl"]):24;b*=36E5;if(a-this.rule["@last_check"]>b)this.next_step=this.download_rule}else this.next_step=this.download_rule;this.do_next()};g.prototype.download_rule=function(){var a=this.wl[this.host],a=pg_instance.get_cx_server_location()+"/"+a.substring(a.length-2)+"/"+a+".txt",b=this,c=[];if(this.rule&&"@last_modified"in this.rule){var d=new Date(parseInt(this.rule["@last_modified"]));c[0]={name:"If-Modified-Since",value:d.toUTCString()}}conduit.network.httpRequest({method:"GET",
url:a,headers:c},function(a,c,d){a={status:d,responseText:a,statusText:d==200?"OK":"Failed "+d.toString()};try{if(b.next_step=b.done,a.status==200){var e=$pg_namespace.decode(a.responseText),e=e.replace(/<\?xml[^?]+\?>/,""),f;a:{try{if(window.DOMParser){f=(new DOMParser).parseFromString(e,"text/xml");break a}else for(a=["Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"];0<a.length;){var g=new ActiveXObject(a[0]);g.async=!1;g.loadXML(e);g.setProperty("SelectionLanguage","XPath");f=g;break a}}catch(h){}f=
null}var n=f.getElementsByTagName("rule");if(n.length>0){var i=n[0],o=i.getAttribute("name"),r=xml2json(i,"");r["@last_check"]=(new Date).valueOf();r["@last_modified"]=(new Date).valueOf();var r=$pg_namespace.unescape(JSON.stringify(r)),s=pg_settings.HOST_WL_RULES_KEY_PREFIX+o;pg_conf.global.set(s,r);b.rule_json=r}}else if(b.rule&&a.status==304)b.next_step=b.done,b.rule["@last_check"]=(new Date).valueOf(),b.rule_json=JSON.stringify(b.rule),o=b.rule["@name"],s=pg_settings.HOST_WL_RULES_KEY_PREFIX+
o,pg_conf.global.set(s,b.rule_json)}catch(x){}b.do_next()},function(){})};var f=function(){var a=pg_conf.global.get(pg_settings.WL_UPDATE_QUEUE_KEY);try{a=JSON.parse(a)}catch(b){a=null}if(a==null||!("ts"in a)||!("files"in a))a={ts:0,files:[]};return a},i=function(a,b){if(typeof a!="object"||!("ts"in a)||!("files"in a))a.ts=0,a.files=[];pg_conf.global.set(pg_settings.WL_UPDATE_QUEUE_KEY,JSON.stringify(a),b);a.files.length==0&&pg_conf.global.set(pg_settings.WL_UPDATE_TIMESTAMP_KEY,a.ts.toString(),b)},
o=function(){var a=f(),b=a.files.length;b&&(a=a.files.splice(Math.random()*b,1),h(a[0]))};return{init:function(){o()},get_rules:function(a,b){new g(a,b);return!0},reset_catalogs:function(){d().forEach(function(a){a=pg_settings.WL_FILE_KEY_PREFIX+a;e(a);pg_conf.global.del(a,!0)});pg_conf.global.del(pg_settings.WL_UPDATE_TIMESTAMP_KEY,!0);pg_conf.global.commit()},get_timestamp:function(){var a=pg_conf.global.get(pg_settings.WL_UPDATE_TIMESTAMP_KEY);a||(a=0);return parseInt(a)},settings_update:function(a){var b=
a.sites_rules_files,c=b.timestamp,a=b.update_files;pg_instance.set_wl_catalogs_url(b.server_location);b=f();b.ts=c;for(var c=0,d=a.length;c<d;++c){var e=a[c].toLowerCase().replace(".xml",".txt");-1==b.files.indexOf(e)&&b.files.push(e)}i(b,!1);o()}}}();
if(!Array.prototype.forEach)Array.prototype.forEach=function(a,b){var d,c;if(this==null)throw new TypeError("this is null or not defined");var e=Object(this),h=e.length>>>0;if({}.toString.call(a)!="[object Function]")throw new TypeError(a+" is not a function");b&&(d=b);for(c=0;c<h;){var g;c in e&&(g=e[c],a.call(d,g,c,e));c++}};
if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a){if(this==null)throw new TypeError;var b=Object(this),d=b.length>>>0;if(d===0)return-1;var c=0;arguments.length>0&&(c=Number(arguments[1]),c!=c?c=0:c!=0&&c!=Infinity&&c!=-Infinity&&(c=(c>0||-1)*Math.floor(Math.abs(c))));if(c>=d)return-1;for(c=c>=0?c:Math.max(d-Math.abs(c),0);c<d;c++)if(c in b&&b[c]===a)return c;return-1};if(!String.prototype.trim)String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};
$pg_namespace.matcher=function(a,b){this.subject=a;this.rule=b;this.found=!1;this.id=this.value=null;this.logger=$pg_namespace.logger};
$pg_namespace.matcher.prototype={match:function(){this.found=!1;this.value=null},exec:function(){this.match();return this.match_found()},match_found:function(){return this.found},get_value:function(){try{if(!this.match_found())return"";if(typeof this.value=="string")return $pg_namespace.encodeURIComponent("@name"in this.rule?this.rule["@name"]:"q")+"="+$pg_namespace.encodeURIComponent(this.value);var a=[];if(this.value)if(this.rule.fp){var b=this.rule.fp;"#cdata"in b&&(b=b["#cdata"]);this.value.forEach(function(a){var d=
"@name"in a.rule?a.rule["@name"]:"q";a.url_value?a=a.url_value:(a=a.get_value(),a=a.replace($pg_namespace.encodeURIComponent(d)+"=",""));b=b.replace("#"+d+"#",a)});a.push(b)}else this.value.forEach(function(b){a.push(b.get_value())});return a.join("&")}catch(d){}return""},set_id:function(a){this.id=a[0];a.shift();this.id_args=a},is_hint:function(){return this.id=="uv"||this.id=="uf"},match_reg_exp:function(a,b){var d=RegExp($pg_namespace.decode_reg_exp(b),"i");if(d=a.match(d)){this.value=d[d.length-
1].trim().toString();if(this.del)this.value=this.value.toLowerCase().replace(this.del,"");this.found=!0}},matcher_from_rule:function(a){if("js"in a)return new $pg_namespace.javascript_matcher(this.subject,a);if(!("@id"in a))return new $pg_namespace.dom_elem_matcher(this.subject,a);var b=a["@id"].split(":");if(b.length==1)return a=new $pg_namespace.dom_elem_matcher(this.subject,a),a.set_id(b),a;var d={cnq:{matcher:$pg_namespace.dom_elem_matcher,id_parts:3},cnc:{matcher:$pg_namespace.dom_elem_matcher,
id_parts:3},idc:{matcher:$pg_namespace.dom_elem_matcher,id_parts:3},"const":{matcher:$pg_namespace.const_matcher,id_parts:2},urex:{matcher:$pg_namespace.page_url_matcher,id_parts:2},trex:{matcher:$pg_namespace.doc_title_matcher,id_parts:2},trmv:{matcher:$pg_namespace.doc_title_matcher,id_parts:2},uvp:{matcher:$pg_namespace.page_url_matcher,id_parts:2},ufp:{matcher:$pg_namespace.page_url_matcher,id_parts:2},uv:{matcher:$pg_namespace.page_url_matcher,id_parts:2},uf:{matcher:$pg_namespace.page_url_matcher,
id_parts:2}},c=b[0];if(c in d)return d=d[c],a=new d.matcher(this.subject,a),b.length>d.id_parts&&(d=b.splice(d.id_parts-1,b.length-d.id_parts+1),b.push(d.join(":"))),a.set_id(b),a;return null}};
$pg_namespace.url_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b);this.url=$pg_namespace.decodeURI(a.url).toLowerCase();this.rex_only="@rex_only"in this.rule&&this.rule["@rex_only"]=="1";this.key_part="del"in this.rule?this.rule.del.toLowerCase():null;this.reg_exp=b.reg.toLowerCase();this.reg_exp=this.reg_exp.replace(/([^\\]?)\{/g,"$1(").replace(/([^\\]?)\}/g,"$1)");this.url_value=null;this.url_found=!1};
$pg_namespace.url_matcher.prototype={match:function(){this.value=[];$pg_namespace.matcher.prototype.match.apply(this,arguments);if(!this.rex_only&&this.key_part)this.url_value=$pg_namespace.find_value(this.url,this.key_part),this.url_found=this.url_value!=null;if(!this.url_found&&($pg_namespace.matcher.prototype.match_reg_exp.call(this,this.url,this.reg_exp),this.url_found=this.found,this.url_value=this.value,this.found=!1,this.value=[],this.url_found&&this.key_part))this.url_value=this.url_value.replace(this.key_part,
"");if(this.url_found&&"param"in this.rule){var a=this.rule.param;a.length==void 0&&(a=[a]);this.value=[];for(var b=0,d=a.length;b<d;++b){var c=this.matcher_from_rule(a[b]);if(c.exec())this.value.push(c),this.found=!0}}},match_found:function(){return this.url_found},get_value:function(){try{if(!this.match_found())return"";var a=$pg_namespace.matcher.prototype.get_value.call(this),b="q="+this.url_value.trim().toString();a.length>0&&(b=b+"&"+a);return b}catch(d){}return""}};
$pg_namespace.extend($pg_namespace.url_matcher,$pg_namespace.matcher);$pg_namespace.dom_elem_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b);this.doc=a.doc;this.del="@del"in this.rule?this.rule["@del"].toLowerCase():null};
$pg_namespace.dom_elem_matcher.prototype={match:function(){$pg_namespace.matcher.prototype.match.apply(this,arguments);var a=this.rule,b=this.get_root_elem();if(b&&("#text"in a&&(b=this.walk(b,a["#text"])),b&&!("@tag"in a&&b.tagName.toLowerCase()!=a["@tag"].toLowerCase()))){if("@attribute"in a&&a["@attribute"].length>0){var d=a["@attribute"],c=a["@value"],a=RegExp("@type"in a&&a["@type"].toLowerCase()=="contain"?c:"^"+c+"$","i"),c=b.getAttribute(d);if(!c||c==null)return;this.del&&(c=c.toLowerCase().replace(this.del,
""));if(!c.match(a))return}else if("@value"in a&&a["@value"].length>0&&(d=b.innerText||b.textContent,this.del&&(d=d.toLowerCase().replace(this.del,"")),c=a["@value"],a=RegExp("@type"in a&&a["@type"].toLowerCase()=="contain"?c:"^"+c+"$","i"),!d.match(a)))return;this.found=!0;this.value=b}},get_root_elem:function(){if(!("@id"in this.rule))return this.doc;if(this.id_args.length==0)return this.doc.getElementById(this.id);for(var a=this.id,b=this.id_args[1],d=this.doc.getElementsByTagName(this.id_args[0]),
c=a=="cnq"||a=="cnc"?"class":"id",a=RegExp(a=="idc"||a=="cnc"?b:"^"+b+"$"),e=0,h=d.length;e<h;++e){var g=d[e];if((b=g.getAttribute(c))&&b.match(a))return g}return null},walk_map:{c:"firstChild",s:"nextSibling",r:"previousSibling",p:"parentNode",l:"lastChild"},walk:function(a,b){if(!a||b.length==0)return a;var d=b.charAt(0),c=this.walk_map[d.toLowerCase()];if((a=a[c])&&d.toLowerCase()==d){d=this.walk_map[c=="nextSibling"||c=="firstChild"?"s":"r"];for(c=a;a&&(a.nodeType==Node.TEXT_NODE||a.nodeType==
Node.COMMENT_NODE);)(a=a[d])&&(c=a);a=c}return this.walk(a,b.substr(1))},get_value:function(){if(this.match_found()&&(this.value=(this.value.innerText||this.value.textContent).trim().toString(),this.del))this.value=this.value.toLowerCase().replace(this.del,"");return $pg_namespace.matcher.prototype.get_value.call(this)}};$pg_namespace.extend($pg_namespace.dom_elem_matcher,$pg_namespace.matcher);$pg_namespace.const_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b)};
$pg_namespace.const_matcher.prototype={match:function(){$pg_namespace.matcher.prototype.match.apply(this,arguments);this.value=this.rule["@id"].split(":")[1];this.found=!0}};$pg_namespace.extend($pg_namespace.const_matcher,$pg_namespace.matcher);$pg_namespace.javascript_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b);if("#cdata"in b.js)b.js=b.js["#cdata"]};
$pg_namespace.javascript_matcher.prototype={match:function(){$pg_namespace.matcher.prototype.match.apply(this,arguments);try{this.found=this.value=eval("var document = this.subject.doc; function pgFoo() {"+this.rule.js+"}; this.value = pgFoo();")}catch(a){this.found=!1}}};$pg_namespace.extend($pg_namespace.javascript_matcher,$pg_namespace.matcher);
$pg_namespace.page_url_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b);this.url=$pg_namespace.decodeURI(a.url).toLowerCase();this.del="@del"in this.rule?this.rule["@del"].toLowerCase():null;this.url_value=null;this.url_found=!1};
$pg_namespace.page_url_matcher.prototype={match:function(){$pg_namespace.matcher.prototype.match.apply(this,arguments);var a="match_"+this.id;if(a in this)this[a](this.id_args[0])},match_urex:function(a){$pg_namespace.matcher.prototype.match_reg_exp.call(this,this.url,a);this.url_found=this.found;this.url_value=this.value;this.found=!1;this.value=[];if(this.match_found()&&"@value"in this.rule){var a=this.rule["@value"].toLowerCase(),b="@type"in this.rule&&this.rule["@type"].toLowerCase()=="equal"?
"equal":"contain";this.url_value=this.url_value.toLowerCase();if(this.del)this.url_value=this.url_value.toLowerCase().replace(this.del,"");if(b=="equal"&&this.url_value!=a||b=="contain"&&this.url_value.indexOf(a)==-1)this.url_value=null,this.url_found=!1}},match_uvp:function(a){var b=$pg_namespace.kv_pairs_from_str(this.url),a=a.toLowerCase(),d;for(d in b)if(d==a){this.url_value=b[d].trim().toString();if(this.del)this.url_value=this.url_value.toLowerCase().replace(this.del,"");this.url_found=!0;break}},
match_ufp:function(a){var b=this.subject.doc.location.pathname;b.charAt(0)=="/"&&(b=b.substring(1));b=b.split("/");if(b.length>=a){this.url_value=b[a-1].trim().toString();if(this.del)this.url_value=this.url_value.toLowerCase().replace(this.del,"");this.url_found=!0}},match_uv:function(a){this.match_uvp(a)},match_uf:function(a){this.match_ufp(a)},match_found:function(){return this.url_found},get_value:function(){if(!this.match_found())return"";var a=$pg_namespace.matcher.prototype.get_value.call(this),
b=$pg_namespace.encodeURIComponent("@name"in this.rule?this.rule["@name"]:"q")+"="+this.url_value.trim().toString();a.length>0&&(b=b+"&"+a);return b}};$pg_namespace.extend($pg_namespace.page_url_matcher,$pg_namespace.matcher);$pg_namespace.doc_title_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b);this.title=a.title;this.del="@del"in this.rule?this.rule["@del"].toLowerCase():null};
$pg_namespace.doc_title_matcher.prototype={match:function(){$pg_namespace.matcher.prototype.match.apply(this,arguments);var a="match_"+this.id;if(a in this)this[a](this.id_args[0])},match_trex:function(a){$pg_namespace.matcher.prototype.match_reg_exp.call(this,this.title,a)},match_trmv:function(a){var b=this.title.toLowerCase();a.toLowerCase().split(";").forEach(function(a){b=b.replace(RegExp(a,"gi"),"")});if(b.length)this.value=b.trim().toString(),this.del&&(attribute=attribute.toLowerCase().replace(this.del,
"")),this.found=!0}};$pg_namespace.extend($pg_namespace.doc_title_matcher,$pg_namespace.matcher);$pg_namespace.product_matcher=function(a,b){$pg_namespace.matcher.call(this,a,b);this.service_type="@service"in b?b["@service"]:$pg_namespace.DEFAULT_SERVICE_TYPE};
$pg_namespace.product_matcher.prototype={match:function(){$pg_namespace.matcher.prototype.match.apply(this,arguments);if("match"in this.rule){var a=this.rule.match;a.length==void 0&&(a=[a]);for(var b=0,d=a.length;b<d;++b){var c=a[b],c=this.matcher_from_rule(c);if(!c.exec())return}}if("param"in this.rule){a=this.rule.param;a.length==void 0&&(a=[a]);this.value=[];b=0;for(d=a.length;b<d;++b)if(c=a[b],c=this.matcher_from_rule(c),c.exec())this.value.push(c),this.found=this.found||!c.is_hint()}},get_value:function(){var a=
$pg_namespace.matcher.prototype.get_value.call(this);if(a.length==0)return a;if("param"in this.rule&&this.rule.fp){var b=this.rule.param;b.length==void 0&&(b=[b]);for(var d=0,c=b.length;d<c;++d)var e=b[d],a=a.replace("#"+("@name"in e?e["@name"]:"q")+"#","")}return[a,"service="+this.service_type].join("&")}};$pg_namespace.extend($pg_namespace.product_matcher,$pg_namespace.matcher);
$pg_namespace.site_matcher=function(a,b,d){var c={};a?(c.doc=a,c.url=a.location.href,c.title=a.title):(c.doc=null,c.url=b,c.title="");$pg_namespace.matcher.call(this,c,d);this.site_id="@id"in d?d["@id"]:"";this.site_type="@type"in d?parseInt(d["@type"]):$pg_namespace.DEFAULT_SITE_TYPE};
$pg_namespace.site_matcher.prototype={match:function(){try{$pg_namespace.matcher.prototype.match.apply(this,arguments);this.value=[];var a=this.rule;if(!this.subject.doc&&"url"in a){if(a.url.length==void 0)a.url=[a.url];for(var b=0,d=a.url.length;b<d;++b){var c=new $pg_namespace.url_matcher(this.subject,a.url[b]);if(c.exec()){this.value.push(c);this.found=!0;return}}}if(this.subject.doc&&!this.match_found()&&this.subject.doc&&"product"in a){if(a.product.length==void 0)a.product=[a.product];b=0;for(d=
a.product.length;b<d;++b)if(c=new $pg_namespace.product_matcher(this.subject,a.product[b]),c.exec()){this.value.push(c);this.found=!0;break}}}catch(e){}},get_value:function(){try{var a=$pg_namespace.matcher.prototype.get_value.call(this);if(a.length==0)return a}catch(b){}return[a,"site_num="+this.site_id,"st="+this.site_type].join("&")}};$pg_namespace.extend($pg_namespace.site_matcher,$pg_namespace.matcher);
function pg_offers_popup(a,b){this.tid=b;this.url=a;this.id=null;this.posTop=this.height=this.width=0;var d=this;conduit.messaging.onTopicMessage.addListener("popup_"+this.tid,function(a){d.on_message(a)});this.WINDOW_HEIGHT=this.WINDOW_WIDTH=0;this.WINDOW_HEIGHT_RATE=10;this.WINDOW_HEIGHT_STEP=4;this.WINDOW_POS_LEFT=this.WINDOW_TARGET_POS_TOP=0}
pg_offers_popup.prototype={offers_html:"pg_offers.html",def_w:1,def_h:1,def_horiz_offset:17,def_bottom_offset:0,show:function(){this.id?conduit.app.popup.show(this.id):this.open()},hide:function(){return this.close()},open:function(){this.id?conduit.app.popup.show(this.id):this.create()},close:function(){if(this.id)conduit.app.popup.close(this.id),this.id=null},create:function(){try{$this=this,this.calc_pos2(this.def_w,this.def_h,function(a,d){var c={dimensions:{width:$this.def_w,height:$this.def_h},
showFrame:!1,closeOnExternalClick:!1,openPosition:"offset("+a+","+d+")",isFocused:!1,isLightFrame:!1,isAbsolute:!0,tabId:$this.tid};$this.width=c.dimensions.width;$this.height=c.dimensions.height;conduit.app.popup.open($this.offers_html+"?pg_data="+$pg_namespace.str2hex($pg_namespace.jsonstr({tid:$this.tid,url:$this.url})),c,$this.openned(),$this.failed())})}catch(a){}},calc_pos2:function(a,b,d){$this=this;conduit.platform.getScreenWidth(function(c){conduit.platform.getScreenHeight(function(e){d(c-
a-$this.def_horiz_offset,e-b-$this.def_bottom_offset)})})},set_param:function(a,b){this.params[a]=b},reposition:function(){$this=this;this.calc_pos2(this.width,this.height,function(a,b){$this.popup_position(a,b)})},popup_position:function(a,b,d){conduit.app.popup.changePosition(this.id,b,a,d)},popup_resize:function(a,b,d){this.width=a;this.height=b;$this=this;conduit.app.popup.resize(this.id,{width:a,height:b},d)},set_width:function(a){$this=this;this.popup_resize(a,this.height,function(){$this.reposition()})},
set_height:function(a){$this=this;this.popup_resize(this.width,a,function(){$this.reposition()})},display:function(){},display2:function(){if(this.WINDOW_HEIGHT==0)this.set_height(0);else var a=window.setInterval(function(b){return function(){var d=parseInt(b.posTop),c=d<b.WINDOW_TARGET_POS_TOP?1:d>b.WINDOW_TARGET_POS_TOP?-1:0;if(c!=0){d+=b.WINDOW_HEIGHT_STEP*c;if(c<0&&d<b.WINDOW_TARGET_POS_TOP)d=b.WINDOW_TARGET_POS_TOP;else if(c>0&&d>b.WINDOW_TARGET_POS_TOP)d=b.WINDOW_TARGET_POS_TOP;b.popup_position(b.WINDOW_POS_LEFT,
d);b.posTop=d;if(d!=b.WINDOW_TARGET_POS_TOP)return}window.clearInterval(a)}}(this),this.WINDOW_HEIGHT_RATE)},display3:function(){if(this.WINDOW_HEIGHT==0)this.set_height(0);else var a=window.setInterval(function(b){return function(){var d=parseInt(b.posTop),c=d<b.WINDOW_TARGET_POS_TOP?1:d>b.WINDOW_TARGET_POS_TOP?-1:0;if(c!=0){var e=d+b.WINDOW_HEIGHT_STEP*c,h;if(c<0){h=b.height+b.WINDOW_HEIGHT_STEP;if(e<b.WINDOW_TARGET_POS_TOP)e=b.WINDOW_TARGET_POS_TOP,h=b.WINDOW_HEIGHT;b.popup_position(b.WINDOW_POS_LEFT,
e,function(){b.popup_resize(b.width,h)})}else{var g=!1;h=b.height-b.WINDOW_HEIGHT_STEP;if(e>b.WINDOW_TARGET_POS_TOP)e=b.WINDOW_TARGET_POS_TOP,h=b.WINDOW_HEIGHT,g=!0;b.popup_resize(b.width,h,function(){b.popup_position(b.WINDOW_POS_LEFT,g?e:e-3)})}b.posTop=e;if(e!=b.WINDOW_TARGET_POS_TOP)return}window.clearInterval(a)}}(this),this.WINDOW_HEIGHT_RATE)},display4:function(){if(this.WINDOW_HEIGHT==0)this.set_height(0);else{var a=parseInt(this.posTop),b=a<this.WINDOW_TARGET_POS_TOP?1:a>this.WINDOW_TARGET_POS_TOP?
-1:0;if(b!=0){var d=a+this.WINDOW_HEIGHT_STEP*b,c;if(b<0){c=this.height+this.WINDOW_HEIGHT_STEP;if(d<this.WINDOW_TARGET_POS_TOP)d=this.WINDOW_TARGET_POS_TOP,c=this.WINDOW_HEIGHT;var e=this;this.popup_position(this.WINDOW_POS_LEFT,d,function(){e.popup_resize(e.width,c,function(){d!=e.WINDOW_TARGET_POS_TOP&&e.display4()})})}else{var h=!1;c=this.height-this.WINDOW_HEIGHT_STEP;if(d>this.WINDOW_TARGET_POS_TOP)d=this.WINDOW_TARGET_POS_TOP,c=this.WINDOW_HEIGHT,h=!0;e=this;this.popup_resize(this.width,c,
function(){e.popup_position(e.WINDOW_POS_LEFT,h?d:d-3,function(){d!=e.WINDOW_TARGET_POS_TOP&&e.display4()})})}this.posTop=d}}},displayIE:function(){if(this.WINDOW_HEIGHT==0)this.set_height(0);else{var a=parseInt(this.posTop),b=a<this.WINDOW_TARGET_POS_TOP?1:a>this.WINDOW_TARGET_POS_TOP?-1:0;if(b!=0){var d=a+this.WINDOW_HEIGHT_STEP*b;if(b<0){if(d<this.WINDOW_TARGET_POS_TOP)d=this.WINDOW_TARGET_POS_TOP;var c=this;this.popup_position(this.WINDOW_POS_LEFT,d,function(){d!=c.WINDOW_TARGET_POS_TOP&&window.setTimeout(function(){c.displayIE()},
c.WINDOW_HEIGHT_RATE-9)})}else{a=!1;if(d>this.WINDOW_TARGET_POS_TOP)d=this.WINDOW_TARGET_POS_TOP,a=!0;c=this;this.popup_position(c.WINDOW_POS_LEFT,a?d:d-3,function(){d!=c.WINDOW_TARGET_POS_TOP&&c.displayIE()})}this.posTop=d}}},set_size:function(a,b){if(!(this.id==void 0||this.id==null))this.WINDOW_WIDTH=parseInt(a),this.WINDOW_HEIGHT=parseInt(b),$this=this,this.calc_pos2(a,b,function(d,c){pg_instance.get_browser_type()=="ff"&&(c-=3);$this.posTop=c+b-$this.height;$this.WINDOW_TARGET_POS_TOP=c;$this.WINDOW_POS_LEFT=
d;$this.width=a;pg_instance.get_browser_type()=="ie"?$this.popup_resize(a,b,function(){$this.displayIE()}):($this.WINDOW_POS_LEFT-=13,$this.display4())})},openned:function(){var a=this;return function(b){a.popup_openned(b)}},failed:function(){var a=this;return function(b){a.popup_failed(b)}},popup_openned:function(a){this.id=a},popup_failed:function(){},on_message:function(a){this.handle_message(a)},handle_message:function(a){try{var b=typeof a=="string"?JSON.parse(a):a;this[b.method]&&this[b.method].apply(this,
b.args)}catch(d){}}};
var pg_logger=$pg_namespace.logger,pg_catalogger=null,isSelectionLocked=!1,pg_tabs_manager=function(){var a={},b=0;return{init:function(){function a(){conduit.tabs.onCreated.addListener(function(a){pg_tabs_manager.get_handler(a)});conduit.tabs.onRemoved.addListener(function(a){pg_tabs_manager.remove_tab(a)});conduit.tabs.onNavigateComplete.addListener(function(a,b,d){pg_instance.get_user_agree()&&(d==void 0||d==!0)&&pg_tabs_manager.tab_updated(a.tabId,{status:"loading",post_data:b},a)});conduit.tabs.onDocumentComplete.addListener(function(a,
b){(b==void 0||b==!0)&&pg_tabs_manager.tab_updated(a.tabId,{status:"complete"},a)})}conduit.windows.getAll({populate:!0},function(b){try{for(var e=0,h=b.length;e<h;++e){var g=b[e].tabs;if(!(g instanceof Array)){var f=[],i;for(i in g)f.push(g[i]);g=f}for(var f=0,o=g.length;f<o;++f){var n=g[f];n.tabId=n.tabId.toString();pg_tabs_manager.get_handler(n);pg_tabs_manager.do_tab_update(n,{status:"complete"},n)}}a()}catch(j){}})},tab_updated:function(a,b,e){pg_tabs_manager.do_tab_update(e,b)},do_tab_update:function(b,
c){var e=c.status;b.post_data=typeof c.post_data!="undefined"&&c.post_data?c.post_data:null;!$pg_release_build&&b.url.indexOf("http://www.pricegong.com/?ConduitDebug")!=-1&&(pg_open_debug_dlg(),alert("debug"),showDebugPopup=!0);showDebugPopup=!1;e=="loading"?EBNavigateComplete(b):e=="complete"&&EBDocumentComplete(b);b.tabId in a&&!a[b.tabId].is_selected&&b.selected&&this.select_tab(b.tabId)},add_tab:function(b,c){b in a||(a[b]=c)},remove_tab:function(b){b in a&&(a[b].on_close(),delete a[b])},select_tab:function(b){if(b in
a){var c=a[b];if(c.has_offers()){c.set_selected(!0);for(var e in a)e!=b&&a[e].set_selected(!1)}}},hide_other_offers:function(b){for(var c in a)c!=b&&a[c].set_selected(!1)},find_handler:function(b){return a[b]},get_handler:function(a){return this.get_handler_by_tabid(a.tabId)},get_handler_by_tabid:function(b){var c=a[b];c||(c=new pg_page_handler(b),this.add_tab(b,c));return c},call_all:function(){var b=Array.prototype.shift.call(arguments),c;for(c in a){var e=a[c];e[b].apply(e,arguments)}},set_skip_one:function(){++b},
skip_one:function(){return b==0?0:b--}}}();function pg_global_notify(){}function pg_reset_catalogs(){alert("Reset catalog may take a few seconds.");pg_catalogger.reset_catalogs();alert("Reset done.\r\nMake sure you clear the browser cache !")}function pg_reset_first_run(){pg_instance.reset_first_run();pg_reset_catalogs()}function pg_reset_settings(){pg_settings_manager.reset()}function pg_notify_prefs_changed(){}
function pg_show_rule_file(a){try{var b=pg_conf.global.get(pg_settings.HOST_WL_RULES_KEY_PREFIX+a);b?(b=b.replace(/[\\]{1}\'/,"\\\\'"),console.debug(b),alert(b)):alert("Rule not found: "+a)}catch(d){alert(d.message)}}function pg_reset_rule_file(a){var b=pg_settings.HOST_WL_RULES_KEY_PREFIX+a;pg_conf.global.get(b)?(pg_conf.global.del(b),alert("Rule deleted.\r\nMake sure you clear the browser cache !")):alert("!!!Rule not found!!!: "+a)}
function pg_reset_rule_file_last_check(a){try{var b=pg_settings.HOST_WL_RULES_KEY_PREFIX+a,d=pg_conf.global.get(b);if(d){var d=d.replace(/[\\]{1}\'/,"\\\\'"),c=JSON.parse(d);c["@last_check"]=0;d=JSON.stringify(c);pg_conf.global.set(b,d);alert("Rule last check set to 0")}else alert("Rule not found: "+a)}catch(e){alert(e.message)}}function pg_set_country_code(a){pg_instance.set_country_code(a)}function pg_set_user_group(a){pg_instance.set_user_group(a)}
function pg_set_last_settings_update(a){pg_instance.set_last_settings_update(a);pg_settings_manager.reschedule()}function pg_set_settings_interval(a){pg_instance.set_last_settings_update((new Date).valueOf());pg_instance.set_settings_update_interval(a);pg_settings_manager.reschedule()}function pg_set_settings_url(a){pg_instance.set_settings_url(a)}function pg_set_wl_cat_url(a){pg_instance.set_wl_catalogs_url(a)}function pg_set_xml_cat_url(a){pg_instance.set_xml_catalogs_url(a)}
function pg_set_catalog_type(a){pg_instance.set_catalog_type(a)}function pg_set_offers_url(a){pg_instance.set_offers_url(a)}function pg_set_snooze(a){pg_instance.set_snooze_time(a);pg_notify_prefs_changed()}function pg_reset_snooze(){pg_instance.set_snooze_time(0);pg_notify_prefs_changed()}function pg_reset_last_upgrade_display(){pg_instance.set_last_upgrade_display(0)}function pg_set_impr_type(a){pg_instance.set_impr_type(a);pg_notify_prefs_changed()}
function pg_set_active_site_types(a){pg_instance.set_active_site_types(a);pg_notify_prefs_changed()}function pg_reset_agreement(){pg_conf.global.del($pg_namespace.STG_KEY.USER_AGREE)}function pg_agreement(a){pg_instance.set_user_agree(a.toString());pg_instance.set_enabled(a);save_enable_for_mam();pg_tabs_manager.call_all("do_pending_agreement")}var popupOffsetX=350,popupOffsetY=50,agreementPopupId=-1;function agreementPopupCbSuccess(a){agreementPopupId=a}
function pg_close_agreement_dlg(){agreementPopupId!=-1?(conduit.app.popup.close(agreementPopupId),agreementPopupId=-1):conduit.app.popup.close()}
function pg_open_agreement_dlg(){agreementPopupId!=-1&&pg_close_agreement_dlg();var a=$pg_namespace.extension_msg_key,b;b=pg_instance.is_agreement_set()?pg_instance.is_active():!0;a=a+","+b.toString();conduit.app.popup.open($pg_namespace.AGREEMENT_DLG_PATH+"#"+a,{dimensions:{width:358,height:322},showFrame:!1,closeOnExternalClick:!1,isLightFrame:!1,isAbsolute:!0},agreementPopupCbSuccess)}var debugPopupId=-1,showDebugPopup=!1;
function pg_open_debug_dlg(){debugPopupId!=-1&&(debugPopupId=-1);conduit.app.popup.open("debug/debug.html#"+$pg_namespace.extension_msg_key,{dimensions:{width:580,height:990},showFrame:!1,closeOnExternalClick:!1,isLightFrame:!1,isAbsolute:!0},function(a){debugPopupId=a},function(){alert("Fail to open debug popup")})}var menuPopupId=-1;function menuPopupCbSuccess(a){menuPopupId=a;conduit.app.popup.onClosed.addListener(menuPopupId,function(){menuPopupId=-1})}
function pg_close_menu_dlg(){menuPopupId!=-1?(conduit.app.popup.close(menuPopupId),menuPopupId=-1):conduit.app.popup.close()}function pg_open_menu_dlg(){showDebugPopup?pg_open_debug_dlg():pg_open_agreement_dlg()}function pg_set_menu_size(a,b){conduit.app.popup.resize(menuPopupId,{width:a,height:b})}function pg_open_url(a){conduit.tabs.create({url:a})}function pg_set_google_patch(a){pg_instance.set_google_patch(a);pg_notify_prefs_changed()}
function pg_get_options(){return{search_eng:pg_instance.get_search_engine_enabled(),ecom_search:pg_instance.get_ecom_search_enabled()}}function set_search_engine_enabled(a){pg_instance.set_search_engine_enabled(a=="on");pg_tabs_manager.call_all("offers_state_check")}function set_ecom_search_enabled(a){pg_instance.set_ecom_search_enabled(a=="on");pg_tabs_manager.call_all("offers_state_check")}
function pg_select_catalogger(){pg_instance.get_catalog_type()==$pg_namespace.CATALOG_TYPE_WL&&(pg_catalogger=pg_wl_catalogger)}var pg_debug_init=function(){return pg_instance.get_prefs()},pg_settings_listener={on_settings_update:function(a){try{pg_instance.is_first_run()&&(pg_instance.set_first_run_time(a.server_time),pg_instance.set_first_run(!1)),pg_instance.apply_settings(a),pg_select_catalogger(),pg_catalogger.settings_update(a),pg_notify_prefs_changed()}catch(b){}}};
function pg_is_active(a){if(a.toLowerCase().indexOf("http")!==0)return!1;if(pg_instance.is_agreement_set()&&!pg_instance.is_active())return!1;return!0}var this_window=$pg_namespace.num2hex(Math.random()*4294967295+1,8);function EBNavigateComplete(a){if(pg_is_active(a.url))pg_tabs_manager.get_handler(a).on_navigate_complete(a)}function EBDocumentComplete(a){if(pg_is_active(a.url))pg_tabs_manager.get_handler(a).on_document_complete(a.url)}function EBTabClose(a){pg_tabs_manager.remove_tab(a)}
function EBMessageReceived(a){try{var b=a.tid,d=a.method,c=a.args;typeof c=="string"&&(c=JSON.parse(c));if(b!=void 0){var e=pg_tabs_manager.find_handler(b);if(e)if(typeof e[d]!="undefined")e[d].apply(e,c);else if(d in window)return window[d].apply(null,c)}else if(d in window)return window[d].apply(null,c)}catch(h){}}
var pg_page_handler=function(a){this.tid=a;this.page_msg_key="pg_page_msg_key_"+a+"_"+$pg_namespace.pg_ext_inst;this.skip_first_load=!1;this.last_post_data=null;this.is_selected=!1;this.last_offers_url="";this.reset_page_state()};
pg_page_handler.prototype={reset_page_state:function(){this.url="";this.page_state=$pg_namespace.PAGE_STATE_CREATED;this.rule_result=null;this.page_ready=!1;this.upgrade_info_url=this.nav_result=null;this.page_loaded_while_rule_pending=!1;this.triggernig_impr_type="";this.injected=!1},set_selected:function(a){this.is_selected=a;this.display_offers(a)},on_close:function(){this.close_offers()},display_offers:function(a){a?this.offers_popup?platformInfo.platform.browser!="Firefox"&&this.offers_popup.show():
this.has_offers()&&this.show_offers(this.last_offers_url):this.offers_popup&&this.offers_popup.hide()},has_offers:function(){return this.last_offers_url.length>0},close_offers:function(){if(this.offers_popup)this.offers_popup.close(),this.offers_popup=null},set_skip_first_load:function(){this.skip_first_load=!0},get_last_post_data:function(a){var b="";if(this.last_post_data){b=[];for(k in this.last_post_data)b.push(k+"="+$pg_namespace.encodeURIComponent(this.last_post_data[k]));b=b.join("&");if(a)this.last_post_data=
null}return b},on_navigate_complete:function(a){var b=a.url;this.reset_page_state();a=a.post_data||this.get_last_post_data(!0);this.last_post_data=null;a.length&&(b=b.indexOf("?")==-1?b+"?"+a:b+"&"+a);this.set_page_url(b);this.set_state($pg_namespace.PAGE_STATE_LOADING);this.skip_first_load||this.lookup_rules()},on_document_complete:function(a){var b=this.location;b||(b={host:"none",href:"none"});var d=$pg_namespace.loc_from_url(a);(!b||d.host!=b.host)&&this.reset_page_state();this.set_state($pg_namespace.PAGE_STATE_LOADED);
d.href!=b.href&&this.set_page_url(a);if(a.indexOf("slide_trig=true")==-1)this.skip_first_load?this.skip_first_load=!1:pg_instance.should_display_upgrade_notification()?(this.upgrade_info_url=pg_instance.get_upgrade_info().url,pg_instance.set_last_upgrade_display(0),this.page_inject()):this.rule_result==null?this.lookup_rules():this.handle_page_rule(this.page_state)},on_form_post:function(a,b){this.last_post_data=b},on_page_ready:function(){this.set_state($pg_namespace.PAGE_STATE_READY);this.page_ready=
!0;this.upgrade_info_url?(this.page_msg("get_offers",this.upgrade_info_url),pg_instance.set_last_upgrade_display((new Date).valueOf())):this.handle_page_rule(this.page_state)},on_page_parse_done:function(a){this.set_state($pg_namespace.PAGE_STATE_PARSING_DONE);this.handle_parse_result(a,"page")},on_catalog_result:function(a,b){this.set_page_rule(a,b);this.page_loaded_while_rule_pending&&this.set_page_rule(this.rule_result,$pg_namespace.PAGE_STATE_LOADED)},on_set_snooze:function(a){a=parseInt(a);a=
Math.min($pg_namespace.SNOOZE_MAX_MINUTES,Math.max($pg_namespace.SNOOZE_MIN_MINUTES,a));pg_instance.set_snooze_time(a*6E4);pg_notify_prefs_changed();pg_tabs_manager.call_all("close_offers")},on_open_url:function(a,b){b?conduit.tabs.create({url:a}):conduit.tabs.update(this.tid,{url:a},skip_first)},on_open_url_suspended:function(a,b){var d=function(a){(a=pg_tabs_manager.get_handler(a))&&a.set_skip_first_load()};a+="&slide_trig=true";b?conduit.tabs.create({url:a},d):conduit.tabs.update(this.tid,{url:a},
d)},set_state:function(a){this.page_state=a},set_page_url:function(a){this.url=a;this.location=$pg_namespace.loc_from_url(a)},parse_request:function(a){var b={success:!1,params:""};try{var d=new $pg_namespace.site_matcher(null,this.url,a);if(d.exec())b.success=!0,b.params=d.get_value()}catch(c){}this.handle_parse_result(b,"nav")},lookup_rules:function(){var a=this.page_state,b=this.location.host,d=b.indexOf(":");d!=-1&&(b=b.substring(0,d));this.set_page_rule(pg_catalogger.get_rules(b,function(b){return function(d){b.on_catalog_result(d,
a)}}(this)),a)},set_pending_agreement:function(a,b){this.pending={rules:a,lookup_state:b}},do_pending_agreement:function(){pg_instance.get_user_agree()&&this.pending&&(this.set_page_rule(this.pending.rules,this.pending.lookup_state),delete this.pending,this.page_state==$pg_namespace.PAGE_STATE_LOADED&&(this.rule_result?this.handle_page_rule(this.page_state):this.lookup_rules()))},is_active_site_type:function(){return typeof this.rule_result=="object"&&(this.rule_result.site_type&pg_instance.get_effective_active_site_types())!=
0},is_active_impr_type:function(a){return typeof this.rule_result=="object"&&(a&this.rule_result.impr_types&pg_instance.get_effective_impr_type())!=0},set_page_rule:function(a,b){if(a!=null&&(this.rule_result=a,typeof a=="object"))try{var d=a.rules_str.replace(/[\\]{1}\'/,"\\\\'"),c=JSON.parse(d);this.rule_result.rules_str=d;this.rule_result.rule=c;this.rule_result.site_type="@type"in c?parseInt(c["@type"]):$pg_namespace.DEFAULT_SITE_TYPE;this.rule_result.impr_types="@impr_type"in c?parseInt(c["@impr_type"]):
$pg_namespace.DEFAULT_IMPR_TYPE;pg_instance.is_agreement_set()?this.handle_page_rule(b):(this.set_pending_agreement(a,b),setTimeout(function(){pg_open_agreement_dlg()},500))}catch(e){}},handle_page_rule:function(a){if(this.is_active_site_type()&&pg_instance.get_user_agree())a==$pg_namespace.PAGE_STATE_LOADING?this.is_active_impr_type($pg_namespace.IMPR_TYPE_URL_INVESTIGATION)?this.parse_request(this.rule_result.rule):pg_logger.debug("handle_page_rule - skipping url parsing - IMPR_TYPE_URL_INVESTIGATION not in impression types mask"):
a==$pg_namespace.PAGE_STATE_LOADED?this.is_active_impr_type($pg_namespace.IMPR_TYPE_PRODUCT_PAGE)?this.page_inject():pg_logger.debug("handle_page_rule - skipping page parsing - IMPR_TYPE_PRODUCT_PAGE not in impression types mask"):a==$pg_namespace.PAGE_STATE_READY&&(this.is_active_impr_type($pg_namespace.IMPR_TYPE_PRODUCT_PAGE)?(this.page_msg("parse",this.rule_result.host,this.rule_result.rules_str,pg_instance.get_prefs()),this.set_state($pg_namespace.PAGE_STATE_PARSING)):pg_logger.debug("handle_page_rule - skipping page parsing - IMPR_TYPE_PRODUCT_PAGE not in impression types mask"));
else if(this.rule_result===!0&&a==$pg_namespace.PAGE_STATE_LOADED)this.page_loaded_while_rule_pending=!0},handle_parse_result:function(a,b){if(a&&a.success&&this.is_active_site_type()&&this.is_active_impr_type($pg_namespace.IMPR_TYPE_PRODUCT_PAGE))this.triggernig_impr_type=b=="page"?$pg_namespace.IMPR_TYPE_PRODUCT_PAGE:$pg_namespace.IMPR_TYPE_URL_INVESTIGATION,a.params+="&trig="+this.triggernig_impr_type,a.params+="&impr="+pg_instance.get_impr_type(),this.show_offers(pg_instance.make_offers_url(a.params))},
show_offers:function(a){a!=this.last_offers_url&&this.close_offers();this.last_offers_url=a;if(pg_instance.is_active()){if(!this.offers_popup)this.offers_popup=new pg_offers_popup(a,this.tid);this.offers_popup.open();pg_tabs_manager.hide_other_offers(this.tid)}else pg_instance.is_snoozing()},offers_state_check:function(){this.triggernig_impr_type&&(!this.is_active_site_type()||!this.is_active_impr_type(this.triggernig_impr_type))&&this.page_msg("hide_offers")},page_inject:function(){if(!this.injected)js=
$pg_client_js_inline,conduit.tabs.executeScript(this.tid.toString(),{code:js},function(){return function(){}}(this.tid),function(){return function(){}}(this.tid)),this.injected=!0},page_msg:function(){var a=$pg_namespace.pack_msg_params.apply(null,arguments);conduit.tabs.sendRequest(this.tid.toString(),"msg_from_app",$pg_namespace.str2hex(JSON.stringify(a)),function(){})}};function on_page_message(a,b,d){b={tab:{tabId:b}};a=typeof a=="string"?JSON.parse(a):a;on_message(a,b,d)}
function on_bla_message(a,b,d){a=typeof a=="string"?JSON.parse(a):a;on_message(a,{},d)}function on_message(a,b,d){if(b.tab)a.tid=b.tab.tabId;a=EBMessageReceived(a);d&&d(a)}function pg_post_install_action(){pg_instance.get_post_install_action()&&pg_instance.get_dist_id()=="dist-1"&&pg_instance.get_sub_dist_id()=="sa"&&(pg_open_url($pg_namespace.POST_INSTALL_URL),pg_instance.set_post_install_action(!1))}
if(!Array.prototype.forEach)Array.prototype.forEach=function(a,b){var d,c;if(this==null)throw new TypeError("this is null or not defined");var e=Object(this),h=e.length>>>0;if({}.toString.call(a)!="[object Function]")throw new TypeError(a+" is not a function");b&&(d=b);for(c=0;c<h;){var g;c in e&&(g=e[c],a.call(d,g,c,e));c++}};
if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a){if(this==null)throw new TypeError;var b=Object(this),d=b.length>>>0;if(d===0)return-1;var c=0;arguments.length>0&&(c=Number(arguments[1]),c!=c?c=0:c!=0&&c!=Infinity&&c!=-Infinity&&(c=(c>0||-1)*Math.floor(Math.abs(c))));if(c>=d)return-1;for(c=c>=0?c:Math.max(d-Math.abs(c),0);c<d;c++)if(c in b&&b[c]===a)return c;return-1};if(!String.prototype.trim)String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var platformInfo=null;
function check_installed_ext(){pg_instance.get_extension_guid()!=-1&&conduit.advanced.isExtensionInstalled(pg_instance.get_extension_guid(),function(a){a.result&&pg_instance.set_enabled(!1)},function(){})}function save_enable_for_mam(){var a=pg_instance.is_active_ignore_mam();conduit.encryption.encrypt(a.toString(),function(a){conduit.storage.global.keys.set("PG_ENABLE",a)})}
function on_load(){try{pg_conf.init(function(){save_enable_for_mam();conduit.platform.getInfo(function(a){platformInfo=a;if(platformInfo.app.extraData)if(platformInfo.app.extraData=="GSA1")pg_settings.MANAGED_APP_MODE=0;else if(platformInfo.app.extraData=="GSA2")pg_settings.MANAGED_APP_MODE=1,pg_instance.set_user_agree("true");else if(platformInfo.app.extraData=="MAM")pg_settings.MANAGED_APP_MODE=2,pg_instance.set_user_agree("true");pg_instance.set_sub_dist_id(platformInfo.toolbar.id);pg_instance.set_toolbar_name(platformInfo.toolbar.name);
pg_instance.set_toolbar_version(platformInfo.toolbar.version);pg_instance.set_browser_type(platformInfo.platform.browser);pg_instance.set_browser_version(platformInfo.platform.browserVersion);pg_instance.set_os_version(platformInfo.platform.OS+" "+platformInfo.platform.OSVersion);pg_tabs_manager.init();pg_settings_manager.init();pg_settings_manager.add_listener(pg_settings_listener);pg_select_catalogger();pg_catalogger.init();conduit.messaging.onRequest.addListener("bg",on_bla_message);conduit.tabs.onRequest.addListener("msg_to_bg",
on_page_message,function(){},function(){});pg_post_install_action();conduit.app.icon.onClicked.addListener(pg_open_menu_dlg);check_installed_ext()})})}catch(a){}}function addListener(a,b,d){a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent("on"+b,d)}addListener(window,"load",function(){on_load()},!1);
